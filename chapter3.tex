
\chapter{Mathai-Quillen formula}
\label{chapter3}
\section{Introduction}
Topological quantum fields theories can be constructed based on the
Mathai-Quillen formalism. Although the main breakthroughs in these theories have
been provided in their formulation as twisted $\mathcal{N}=2$ supersymmetric
theories, this provides a useful geometric framework.\cite{TQFTbook}

In general, Witten type TQFTs are associated with a moduli problem characterized
by three basic data: fields, symmetries, and equations.
In the case of Donaldson-Witten theory, the configuration space is the space of
connections $\mathcal{A}$ on a bundle $E$, whose elements are fields 
$\phi$ over a four-manifold  $X$.  the group $\mathcal{G}$ is the group of gauge
transformations associated with $G$, so we are led to consider the quotient
space  $\mathcal{A}/\mathcal{G}$. Within this quotient, the moduli space is
defined by a set of equations $s(\phi)=0$, and the self-duality equations can be
regarded as sections of a bundle
$\mathcal{E}=\mathcal{A}\times_{\mathcal{G}}\Omega^{2,+}(X,g_E)$. (What does
this mean?)
  
Recall that there are two quite different approaches for calculating the Euler number
$\chi(X) = \chi(TX)$ of an oriented even dimensional manifold $X$. 
This first is topological, and counts
the signed isolated zeros of a vector field on $X$, via the Hopf theorem. The
second is differential geometric and represents  $\chi(X)$ as the integral over
$X$ of a density constructed from the curvature of a connection on $X$, via
the Gauss-Bonnet theorem. 

The Mathai-Quillen formula \cite{MQformula} is a more general formula which interpolates between
the two approaches. It relies on the construction of a form $\chi_{s,\nabla}(E)$ in
the Euler class which depends
on both a section  $s$ and connection  $\nabla$.  

\section{Thom isomorphism}
For an orientable vector bundle $\pi:E\to M$ of rank $n$ over a manifold $M$ 
with a finite good cover, it can be shown that  $H_c^*(E)\simeq H_c^{*-n}(M)$.\cite[Prop
6.13]{bott_tu} 
Rapid decrease forms vs compact vertical

\begin{defn}
	A differential form $\omega\in \Omega(E)$ is \underline{rapidly decreasing
	along the fiber} if  $\omega_x$ is in Schwartz space
\end{defn}

Using the diffeomorphism $h : E \to E$ taking the unit ball to $\mathbb{R}^n$
\[
	h(y) = \frac{y}{\sqrt{1-\abs{y^2}} }
\] 
we can pull back a rapidly decreasing form to a smooth form which is supported
on the unit ball bundle. 
All derivatives must approach zero as $y \to 1$

% TODO should I formulate Thom isomorphism only for finite good cover manifolds,
% in particular compact manifolds

Let $E$ be an oriented rank  $n$ vector bundle. We will define integration along
the fiber $\pi_* : \Omega^*_{cv}(E) \to \Omega^{*-n}(M)$. 
Given a local trivialisation and chart on $U_\alpha$, let $x_1,\ldots,x_m$ be 
coordinate functions on $U_\alpha$, and  $t_1,\ldots,t_n$ be fiber coordinates
on $E|_{U_{\alpha}}$. Then a homogeneous form $\omega\in \Omega_{cv}(E)$ either 
contains the $n$-form  $dt_1\wedge \ldots\wedge dt_n$ as a factor, or does not. 
In the latter case, we define $\pi_*(\omega) = 0$, and otherwise 
\[
\omega = (\pi^*\phi)f(x,t_1,\ldots,t_n)dt_1\wedge\ldots\wedge dt_n
\mapsto \phi\int_{\mathbb{R}^n} f(x,t_1,\ldots,t_n) \odif{t_1}\ldots\odif{t_n}
\] 
where $\phi\in\Omega(M)$ and  $f$ has compact support for each fixed  $x\in M$
since  $\omega$ is compact in the vertical direction. 

% exercise 6.14 Bott Tu
The definition of $\pi_*$ is well defined, i.e. it agrees for different local
trivialisations, and is independent of the choice of oriented trivialisation of
 $E$. % TODO 


% TODO move this 
We can similarly define integration along the fiber for $\omega\in
W(\mathfrak{g})\otimes \Omega(V)$, which can be written as $\alpha
f(t)dt_1\wedge\ldots\wedge dt_n$ globally.


\begin{prop}[Projection formula] % Prop 6.15 Bott Tu p63
	(a) Let $\pi : E \to M$ be an oriented vector bundle of rank  $n$,
	$\tau\in\Omega^*(M)$ and  $\omega\in \Omega^*(E)$ with compact support
	along the fiber. Then 
	 \[
	\pi_*((\pi^*\tau)  
	\] 
\end{prop}
\begin{thm}[Thom Isomorphism] % Thm 6.17 Bott Tu
	If a vector bundle $\pi: E \to M$ is orientable with rank $n$, and $M$ has a
	finite good cover, then 
	 $H^*_{cv}(E) \simeq H^{*-n}(M)$
\end{thm}
\begin{defn}
	Under the Thom isomorphism $\mathcal{F}:H^*(M)\to H_{cv}^{*+n}(E)$, the
	image of $1\in H^0(M)$ is called the \underline{Thom class}  $\Phi\in
	H_{cv}^n(E)$ of the vector bundle.
\end{defn}



\section{Construction of Thom form}
Let us first look at the construction on an oriented Euclidean vector bundle
$E\xrightarrow{\pi} M$ of rank $n$ over a point $M=\{x_0\}$. 
Given coordinates $x^1,\ldots,x^n$ on $E$ from the local trivialisation,
a Thom form $U\in \Omega^n_{cv}(E)$ can be defined as
\[
	U(x) = (2\pi)^{-n/2}e^{-\abs{x}^2 /2} dx^1\wedge \ldots\wedge dx^n
\] 
Given the basis $e_1,\ldots,e_n$ of  $V$ corresponding to the coordinates
$x^1,\ldots,x^n$, denote the map $dx = dx^k \otimes e_k \in 
\Omega^1(E, V)$. Then $e^{-idx}\in \Omega(E,\bigwedge V)$ by taking a formal sum
of wedge products.
We can express this form in terms of the Berezin integral,
considered as a map $\int^B := \int \odif{e_1}\cdots\odif{e_n} 
: \Omega^*(E,\bigwedge V) \to \Omega^*(E)$.

\begin{lem} \label{lem:gaussian_integral} %1.49 BGV
	The form $U\in \Omega^n_{cv}(E)$ equals 
	\[
		 U(x) = (2\pi)^{-n/2} e^{-\abs{x}^2 /2} \epsilon(n)\int^B e^{-idx}
	\] 
	where $\epsilon(n)=1$ if  $n$ is even, otherwise  $i$.
\end{lem}
\begin{proof}
	The Berezin integral kills any forms of order less than $n$, so only
	multiples of $e_1 \wedge \ldots\wedge e_n$ remain.
	Hence,
	\begin{align*}
		\int^B e^{-idx} 
		&= (-i)^n \frac{1}{n!}\int^B (dx^k\otimes e_k)^n \\
		&= (-i)^n \int^B dx^1\wedge \ldots\wedge dx^n\otimes e_1 \wedge\ldots\wedge e_n \\
		&= (-i)^n(-1)^{n(n-1)/2} \int^B dx^1\wedge \ldots\wedge dx^n\otimes e_n \wedge\ldots\wedge e_1 \\
		&= (-i)^n(-1)^{n(n-1)/2} dx^1\wedge \ldots\wedge dx^n
	\end{align*}
	In the second line, we have permuted all $n!$ terms into standard order for
	both the $dx^i$ and  $e_i$, so the signs of the permutations cancel.
	In the third line, we needed to reverse the order of the $e_i$ to accomodate
	the order of integration. The lemma now follows, since
	$(-i)^n(-1)^{n(n-1)/2}$ equals 1 if $n$ is even, and otherwise  $-i$. 
\end{proof}
We will define the Thom form on a more general manifold by modification of the
above lemma. Denote $x \in \Omega^0(E,\pi^*E)$ as the \underline{tautological
section}, defined by $e\in E_p \mapsto e\in (\pi^*E)_{e} = E_{p}$.
Then choosing a Euclidean connection $\nabla^E$ on  $E$, we may replace  $dx$ by 
$\nabla^{\pi^*E} x \in \Omega^1(E,\pi^*E)$.

\begin{prop} \label{prop:derivative_berezin} %1.50 BGV
	If $\nabla$ is a metric connection on  $E$, this induces a covariant
	derivative on $\bigwedge E$. Then for any
	$\alpha\in\Omega(M,\bigwedge E)$, we have 
	\[
	d\int^B \alpha = \int^B \nabla\alpha
	\] 
\end{prop}
\begin{proof} 
	Given a non-vanishing section $\nu\in \Omega^1(M,\bigwedge^nE)$,
	the Berezin integral is given by the induced inner product on $\bigwedge E$
	with  $\nu$. Then  $\nabla$ induced on  $\bigwedge E$ is compatible with
	this inner product, and 
	\[
	d\gen{\nu,\omega} = \gen{\nabla \nu, \omega} + \gen{\nu, \nabla \omega}
	=\int^B \nabla\omega
	\] 
	where we have used the fact that $\nabla \nu = 0$, by definition of the
	Berezin integral on an oriented vector bundle with a metric connection.
\end{proof}

We will apply this proposition to the pullback vector bundle $\pi^*E \to E$, 
with induced connection $\nabla^{\pi^*E}=\pi^*\nabla^E$. Denote $V=\pi^*E$ to
simplify notation.
Let $\iota(s):\Omega^i(E,\bigwedge^j V) \to
\Omega^i(E,\bigwedge^{j-1} V)$ for $s\in\Gamma(V)$ be a contraction operator
defined in a similar fashion as \ref{def:contraction}, by the following
properties:
\begin{enumerate}[(1)]
    \item If $w\in \Omega^0(E,V)$, then  $\iota(s)w = \gen{s,w}$
	\item If $\alpha\in\Omega^i(E,\bigwedge^jV),
		\beta\in\Omega^k(E,\bigwedge^lV)$, then 
	 \[
	\iota(x)(\alpha\wedge \beta) 
	= (\iota(x)\alpha)\wedge\beta + (-1)^{i+j}\alpha\wedge(\iota(x)\beta)
	\] 
\end{enumerate}
Note that this uniquely defines $\iota(s)$ because the formulas can be applied
to a basis of $\bigwedge^iT^*E\otimes \bigwedge^jV$.

Denote $\nabla = \nabla^{\pi^*E}$. 
Recall that the curvature is a form in $\Omega^2(E,\End(V))$ 
which is skew-symmetric valued. We can identify $\mathfrak{so}(V)$ with 
$\bigwedge^2 V$ in the following way:
\[
	A\in \mathfrak{so}(V) \mapsto \sum_{i<j} \gen{Ae_i,e_j} e_i\wedge e_j
\] 
given a frame of $V$. Hence, we denote the curvature form as $F \in
\Omega^2(E,\bigwedge^2V)$.

\begin{prop} \label{prop:closed_prop} % 1.51 BGV
	Let $x \in \Omega^0(V)$ be the tautological section on $E$, and $\nabla$ the
	induced connection on $\bigwedge V$.
	Let $\omega_t = \frac{1}{2}t^2\abs{x}^2 + it\nabla x + F 
	\in \Omega(E,\bigwedge V)$. Then 
	\[
		(\nabla - it\iota(x))\omega_t = 0
	\] 
\end{prop}
\begin{proof}
	 By metric compatibility,
	$\nabla \abs{x}^2 = 2\gen{\nabla x, x} = -2\iota(x)\nabla x$.
	Next, we have $\nabla(\nabla x) = \iota(x) F$.
	Finally by Bianchi's identity, $\nabla F = 0$. Combining this,
	\[
	\nabla \omega_t = -t^2\iota(x) \nabla x + it\iota(x)F 
	\] 
	On the other hand, $\iota(x)\abs{x}^2 = 0$ by definition of $\iota(x)$, so
	\[
	it\iota(x)\omega_t = -t^2\iota(x) \nabla x + it\iota(x)F
	\] 
\end{proof}

We now define the Mathai-Quillen Thom form 
\begin{equation}
	U = (2\pi)^{-n/2}\epsilon(N) \int^B e^{-\frac{1}{2}\abs{x}^2-i\nabla x - F} \in \Omega^n(E)
\end{equation}
and its parameterised version $U_t = (2\pi)^{-n/2}\epsilon(N) \int^B e^{-\omega_t} \in
\Omega^n(E)$. To justify why $U_t\in\Omega^n(E)$, note that
$\omega_t\in\bigoplus_{i=0}^2 \Omega^i(E,\bigwedge^iV)$, and hence 
$e^{-\omega_t} \in \bigoplus_{i=0}^n \Omega^i(E,\bigwedge^iV)$. The Berezin
integral then only retains the top degree part. 

\begin{thm}
	The Mathai-Quillen form $U \in \Omega^n_{rd}(E)$ is a Thom form. 
\end{thm}
\begin{proof}
	% BGV Lemma 1.51
	We need to show that $U$ is closed, and integration along the fiber gives $1\in
	\Omega^0(E)$.
	By definition \ref{defn:grassman_function}, the exponential of $-\omega_t$
	is 
	\begin{equation} \label{eq:MQ_exp}
		e^{-\omega_t} = \sum_{k=0}^{n} \frac{e^{-t^2\abs{x}^2 /2}}{k!} (-it\nabla x
		- F)^k
	\end{equation}
	Claim: $(\nabla -it\iota(x)) e^{-\omega_t} = 0$
	% TODO 
	how is it closed  ??
	To show that $U_t$ is closed, we can extend Proposition \ref{prop:derivative_berezin} to 
	$d\int^B\alpha = \int^B (\nabla-it\iota(s))\alpha$ for any	
	$\alpha\in\Omega(\bigwedge V)$ since $\iota(s)\alpha$ has no component in 
	the top exterior power.	
	It follows from this
	and Proposition \ref{prop:closed_prop} that $U_t$ is closed.
	
	% BGV prop 1.52 says integral reduces to the case where $M$ is a point
	% Proof is found from Blau 
	Since $\abs{x}^2 \in \Omega^0(E,\bigwedge^0V)$ is an even Grassman number, 
	the exponential can be factored into two parts: \vspace{-3pt} 
	\[
	U_t = (2\pi)^{-n/2}\epsilon(N) e^{-\frac{1}{2}\abs{x}^2}\int^B e^{-i\nabla x -F}
	\] 
	This is also apparent from equation (\ref{eq:MQ_exp}). 
	To integrate $U_t \in \Omega(E)$ along the fiber of $E$, we extract from
	the Berezin integral the part which is a $n$-form on the fiber of $E$,
	\begin{align*}
		\int_E (2\pi)^{-n/2}\epsilon(N) e^{-\frac{1}{2}\abs{x}^2}\int^B e^{-i\nabla x -F}
		&= (2\pi)^{-n/2}\epsilon(N) \int_E e^{-\frac{1}{2}\abs{x}^2}\int^B 
		e^{-idx}
		= 1 
	\end{align*}
	we are only left with the $dx$ term because the induced connection and
	curvature forms on  $\pi^*E$ do not have any components along the fiber.
	We have evaluated the integral using Lemma \ref{lem:gaussian_integral}.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment} % Blau approach
Let $E=P\times_\rho V$ be the associated bundle to $P$ with rank $2m$. 
basic forms on $P\times V$ are in correspondence with forms on  $E$.

A representative for the Thom class, called the Mathai-Quillen Thom form, is
given by
\begin{equation} \label{eq:mathai_quillen}
\Phi_\nabla(E) = \frac{1}{(2\pi)^m} e^{-v_a^2/2} \int \odif{\chi} 
\exp(\chi_a\Omega^{ab}\chi_b /2 + i\nabla v^a \chi_a)
\end{equation}
where $v^a \in \Omega^0(P\times V)$ are coordinates on $V$, and $\nabla v^a \in
\Omega^1(P\times V)$ is the exterior covariant derivative of $v^a$.
Not well defined globally, since using trivialisation to use coordinates? 

We claim that this defines a basic form in $\Omega^{2m}_\rho(P\times V)$,
and that it is a representative of the Thom class. 

To show that it is a basic form, we need to prove it is horizontal and $\rho$
equivariant.  

To show that is is a representative of the Thom class, we need to prove it is
closed and satisfies  $\pi^*\Phi_\nabla(E) = 1$.

Pullback by zero section is Pfaffian.
\end{comment} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prop} % prop 1.53 BGV
	We have the transgression formula
	\[
	\odv{}{t} U_t = -i\epsilon(N) d\int^B x e^{-\omega_t}
	\] 
\end{prop}
\begin{prop} \label{prop:thom_pullback}
	Let $s\in \Gamma(M,E)$ be a section of $E$.
	The cohomology class of the pullback $s^*\Phi_\nabla(E) \in \Omega^{n}(M)$
	is independent of the section  $s\in\Gamma(E)$.
\end{prop}
\begin{proof}
	Integrating the transgression formula above from 0 to 1, 
	\[
		U_1 - U_0 = -id\int_0^1\int^B x e^{-t^2\abs{x}^2/2 +
		it\nabla x + F} \odif{t}
	\] 
	Note that $s^*U_0 = \epsilon(n)\int^B e^{-s^*F} \in \Omega(M)$. Since $F$ is
	the pullback curvature on $V = \pi^*E$, it is constant on 
	(why is $s^*U$ equal to the Pfaffian? use basis of V).

	Taking the pullback by $s$ on both sides, we find that $s^*U_1$ is
	cohomologous to the Euler class for any section $s$:  
	\[
		s^*U_1 - s^*U_0 = -id\int_0^1\int^B s\wedge e^{-t^2\abs{s}^2/2 +
		it\nabla s + F} \odif{t}
	\] 
	% TODO: complete proof
\end{proof}


\section{Localisation}
One of the primitive applications of the Mathai-Quillen formula is to prove the
Poincar\'e-Hopf theorem. 

Let $E\to M$ be a vector bundle over  $M$, and $v\in\Gamma(E)$ be a section of $E$.
At a zero $p\in M$ of  $v$, the Lie bracket gives an endomorphism 
$\mathcal{L}_p(v) : T_pM \to T_pM$ defined by  $X\mapsto [X,v]$. In a coordinate system in
which  $p=0$ and  $v= v^i \partial_i$,  $\mathcal{L}_p(v)$ is given by 
 \[
	 \mathcal{L}_p(v)\partial_i = \sum_{j=1}^{n} [\partial_i, v^j(p)\partial^j] 
	 = \sum_{j=1}^{n} (\partial_i v_j(p)) \partial_j
\] 
A zero of $p$ is called \underline{non-degenerate} if  $\mathcal{L}_p(v)$ is
invertible. Denote by $\nu(p,v) \in \{\pm 1\}$ the sign of the determinant of
$\mathcal{L}_p(v)$. If all of the zeroes of $v$ are non-degenerate, we call  $v$
non-degenerate. 

\begin{thm}[Poincare-Hopf] % Thm 1.56 BGV
	If $v$ is a non-degenerate vector field on an oriented compact manifold $M$ 
	of dimension $n$, then 
	\[
		 (2\pi)^{-n /2} \int_M \chi(TM) = \sum_{\set{p|v(p)=0}} \nu(p,v)	
	\] 
\end{thm}
\begin{proof}
	(adapted from \cite[Theorem 1.56]{bgv})
	Choose a chart $\phi_p : U_p : \to \mathbb{R}^n$ in a neighbourhood $U_p$ of
	each zero $p\in M$ of $v$, which gives coordinates on the tangent bundle 
	$\psi_p : TU_p \to \mathbb{R}^n$. The vector field $v$ defines a
	smooth map $\psi_p \circ v : U_p\to \mathbb{R}^n$ 
	with $v(p) = 0$ and invertible
	derivative $\mathcal{L}_p(v)$. 
	% TODO why is this the derivative?

	Therefore by the inverse function theorem, $v$ is a local diffeomorphism
	between open neighbourhoods $V_p \subset U_p$ and $B \subset \mathbb{R}^n$. 
	The orientation on $V_p$ induced by  $M$ and by the local diffeomorphism
	differ by the sign $\nu(p,v)$. 

	We may assume  $V_p$ are disjoint for each $p$.  Choose a Riemannian metric
	on $M$ which agrees with the metric on each $V_p$ induced by the diffeomorphism
	into  $\mathbb{R}^n$. Since $M$ is compact,  $\exists \epsilon > 0$ such
	that  $\norm{v} \geq \epsilon$ on the compact set  $M\setminus \bigcup_p V_p$,
	because if $\norm{v}$ can get arbitrarily close to 0, we would find a convergent
	subsequence in $M\setminus \bigcup_p V_p$ whose limit is a zero of $v$.  

	Let $U\in \Omega^n(TM)$ be the Mathai-Quillen Thom form of  $TM$ with respect to the
	Riemannian metric and associated Levi-Civita connection. 
	Let $f : \mathbb{R}_+ \to [0,1]$ be a smooth bump function such that $f(s)=1$
	if  $s < \epsilon^2 /4$ and $f(s)=0$ if  $s>\epsilon^2$. Then for all $t>0$
	\[
		\int_M \chi(TM) = \int_M v_t^* U 
		= \int_M (1-f(\norm{v}^2))v_t^*U  + \int_M f(\norm{v}^2)v_t^*U
	\] 
	where $v_t := tv$. From equation (\ref{eq:MQ_exp}), we see that
	$v_t^* U$ is of the form
	\[
		v_t^*U = e^{-t^2\norm{v}^2 /2} \sum_{k=0}^{n} t^k \alpha_k
	\] 
	where $\alpha_k \in \Omega(M)$.
	On each $V_p$, the metric and connection are trivial since they are induced 
	by $v$, so 
	\begin{align*}
		v_t^*U |_{V_p} 
		&= (2\pi)^{-n/2} e^{-t^2\norm{x}^2 /2} \int^B e^{-itdv} \\
		&= (2\pi)^{-n/2}t^n \nu(p,v) e^{-t^2\norm{x}^2 /2} dx^1 \wedge
		\ldots\wedge dx^n \tag{using Lemma \ref{lem:gaussian_integral}}
	\end{align*}
	The sign $\nu(p,v)$ comes from the fact that the Berezin integral is taken
	with respect to the orientation 
	 
\end{proof}

There is a generalisation of this result, where we assume that the zeroes
of $v$ are isolated instead of non-degenerate.\cite[Theorem 1.58]{bgv} 

% p51 Bott Tu
To every closed (as a subspace) and oriented submanifold $i: S
\xhookrightarrow{} M$ of dimension  $k$, we can
associate a unique cohomology class  $[\eta_s]\in H^{n-k}(M)$ called its
\underline{Poincare dual} as follows. Let $\omega\in \Omega_c^k(M)$ be closed.
Since $\operatorname{supp}(\omega|_S) \subset \operatorname{supp}(\omega) \cap
S$ is a closed subset of a compact set, $i^*\omega$ also has compact support on
$S$, so  $\int_S i^*\omega$ is defined. Hence integration over  $S$ is a  
linear functional on $H^k_c(M)$. It follows by Poincare duality:
$(H_c^k(M))^*\simeq H^{n-k}(M)$, that integration over $S$ corresponds to a
unique cohomology class $[\eta_S]\in H^{n-k}(M)$. 
From the construction of the Poincare duality map, $\eta_S$ satisfies
for any closed $\omega\in \Omega^k_c(M)$
\[
\int_S i^*\omega = \int_M \omega \wedge \eta_S
\] 
\begin{defn}
	Let $S$ be a submanifold of dimension  $k$ in a manifold  $M$ of dimension
	$n$. A \underline{tubular neighbourhood} of  $S$ in  $M$ is an open
	neighbourhood of  $S$ in  $M$ diffeomorphic to a vector bundle of rank
	$n-k$ over  $S$, such that  $S$ is diffeomorphic to the zero section.

	The \underline{normal bundle} of $S$ in  $M$ is the vector bundle on  $S$
	is the quotient bundle $N$ defined by the exact sequence 
	\[
	\begin{tikzcd}[column sep = 1.6em]
		0 \arrow[r] & TS \arrow[r] & TM|_S \arrow[r] 
						& N \arrow[r] & 0
	\end{tikzcd}
	\] 	
\end{defn}

%TODO reference See 
% https://luis.impa.br/aulas/anvar/Spivak_Vol1_3ed.pdf Spival p346
% https://www.math.tecnico.ulisboa.pt/~acannas/Books/lsg.pdf p37
% http://alpha.math.uga.edu/~usher/8210-notes2.pdf Thm 2.11
\begin{thm}[Tubular neighbourhood theorem] 
	Every $S$ submanifold of a smooth manifold $M$ has a 
	tubular neighbourhood  $T$ in $M$, and  
	$T$ is diffeomorphic to the normal bundle of $S$ in $M$.
\end{thm}

Let $S$ be an oriented submanifold of an oriented manifold $M$, which is closed
as a subspace. Let $j:T \hookrightarrow M$ be the inclusion
of a tubular neighborhood of  $S$. Since $S$ and  $M$ are orientable, the normal
bundle is also orientable. % TODO why?

Let $j_*: H_{cv}^{*}(T) \to H^*(M)$ be extension by zero, which is defined 
because % TODO why does Thom form vanish near boundary of S?

\begin{thm}[Poincare dual as a Thom class] % p67 Bott Tu
	The Poincare dual of a submanifold $S^k \subset M^n$ is the Thom class of the
	normal bundle of $S$ in  $M$, i.e. 
	\[
		\int_M \omega\wedge j_*\Phi = \int_S i^*\omega 
	\] 
	for all $\omega\in H^k_c(M)$, and $\Phi\in H^{n-k}(T)$.
\end{thm}
\begin{proof}
	\begin{align*}
		\int_M \omega\wedge j_*\Phi 
		&= \int_T \omega \wedge \Phi \\
		&=  
	\end{align*}
\end{proof}

\begin{thm}[Localisation property] % see pg 69 Bott Tu
	Let $f\in C^\infty(M',M)$ be an orientation-preserving map of oriented
	manifolds, and $S\subset M$ be a closed oriented submanifold. 
	If $f$ is transversal to  $S$ and  $T$, then
	$\eta_{f^{-1}(S)} = f^*\eta_S$, i.e. for all  $\omega\in \Omega^k_c(M')$,
	\[
	\int_{M'} \omega \wedge f^*\eta_S =\int_{f^{-1}(S)} i^*\omega  
	\] 
	where $i: f^{-1}(S) \to M'$ is the inclusion map.
\end{thm}
\begin{proof}
	%TODO why is dimension of f^-1 S the same as S ?, complete proof
	claim $f^{-1}T$ is a tubular neighborhood of $f^{-1}S$ in $M'$

	The following diagram commutes (why?)
	% https://q.uiver.app/?q=WzAsNixbMCwwLCJIXiooUykiXSxbMSwwLCJIXnsqK2t9KFQpIl0sWzIsMCwiSF4qKE0pIl0sWzIsMSwiSF4qKE0nKSJdLFsxLDEsIkheeyora30oZl57LTF9VCkiXSxbMCwxLCJIXiooZl57LTF9UykiXSxbMCw1LCJmXioiXSxbMSw0LCJmXioiXSxbMiwzLCJmXioiXSxbMCwxLCJcXHdlZGdlIFxcUGhpKFQpIl0sWzEsMiwial8qIl0sWzQsMywial8qIl0sWzUsNCwiXFx3ZWRnZSBcXFBoaShmXnstMX1UKSJdXQ==
	\[\begin{tikzcd}[row sep=2.85em, column sep=4.45em]
			{H^*(S)} & {H^{*+k}_{cv}(T)} & {H^*(M)} \\
				{H^*(f^{-1}S)} & {H^{*+k}_{cv}(f^{-1}T)} & {H^*(M')}
					\arrow["{f^*}", from=1-1, to=2-1]
						\arrow["{f^*}", from=1-2, to=2-2]
							\arrow["{f^*}", from=1-3, to=2-3]
								\arrow["{\wedge \Phi(T)}", from=1-1, to=1-2]
									\arrow["{j_*}", from=1-2, to=1-3]
										\arrow["{j_*}", from=2-2, to=2-3]
											\arrow["{\wedge \Phi(f^{-1}T)}",
											from=2-1, to=2-2]
	\end{tikzcd}\]
	Starting with $1\in H^0(S)$, the maps on the top row gives 
	$\eta_S \in H^{n-k}(M) \mapsto f^*\eta_S \in H^{n-k}(M')$ 
	On the other hand, the maps on the bottom row gives
	$\eta_{f^{-1}S} \mapsto \eta_{f^{-1}S} \in H^{n-k}$
\end{proof}

% TODO is there a dimension condition? dim m \geq dim W
\begin{cor} \label{cor:vb_localisation}
	Let $E\to M$ be an oriented vector bundle of rank $k$ over an oriented 
	manifold of dimension $n$, 
	and $s\in\Gamma(M,E)$.
	Then for all $\omega\in \Omega^{n-k}_c(M)$,
	 \[
	\int_M \omega \wedge s^* \Phi(E) =\int_{s^{-1}(0)} i^*\omega  
	\] 
\end{cor}
% TODO does section satisfy transversality conditions, or describe 
% how transversality homotopy theorem does not require this

This follows from choosing the section to be the orientation preserving map, and
choosing the submanifold of $0\subset E$ to be the image of the zero section.
Since $0\subset E$ is a diffeomorphic embedding of $M$ in $E$, and we have the
exact sequence
\[
	\begin{tikzcd}[column sep = 1.6em]
		0 \arrow[r] & T0 \arrow[r] & TE|_0 \arrow[r] 
						& E \arrow[r] & 0
	\end{tikzcd}
	\]
the normal bundle of  $0\subset E$ is  $E$ itself.
Hence $\eta_0 = \Phi(E)$. 

\subsection{Witten localisation formula}
% discussion from Witten N matrix model 3.3, see also cordes 11.10.3
Let $E\to M$ be a vector bundle over a finite-dimensional compact manifold  $M$.
Let $s\in\Gamma(M,E)$ be a generic section and assuming $\dim M \geq \rank E$, 
$S=s^{-1}(0)$ is a submanifold with
Poincare dual $s^*\Phi(E)=\chi(E)$ by Corollary \ref{cor:vb_localisation}. 
By the rank-nullity theorem, we would have $\dim S = \rank M - \rank E$, but 
we wish to consider a non-generic section $s$ of a certain type with 
$\dim S > \dim(M)-\rank(E)$. 



Let  $N\to S$ be the normal bundle of dimension
$\dim(M)-\dim(S)$.  More like $N = \coker (\nabla s)$

Let  $u\in\Gamma(S,N)$ be a generic section and
$P=u^{-1}(0)$ which has Poincare dual $\chi(V')$. Since  $P\subset S \subset M$,
we claim that $i(P)$ is Poincare dual to  $\chi(E)$.
\[
\int_M \chi(E\to M)\wedge \omega = \int_{S} i^*\omega \wedge \chi(N\to S)
\] 
Note that if $s$ is a generic section then  $\coker (\nabla s) = \{0\}$, which
reduces to Corollary \ref{cor:vb_localisation}.



\section{Equivariant version of Mathai-Quillen}
\begin{prop}
	Let $E\to M$ be an oriented vector bundle with fiber $V=\mathbb{R}^n$ 
	and  $P=\Fr_{\SO}(E)$ be the
	principal $\SO(n)$-bundle of orthonormal oriented frames on  $E$. Then 
	$P\times_{\SO(n)} V$ is canonically isomorphic to $E$ as a vector bundle. 
\end{prop} 
\begin{proof}
	The action of $A\in\SO(n)$ on $P\times V$ is 
	$
		([v_1 \cdots v_n], v) \cdot A = ([v_1 \cdots v_n] A, A^{-1} v) 
	$.
	Then the canonical isomorphism $\psi : P\times_{\SO(n)} V \to E$ is defined by
	\[
		[[v_1 \cdots v_n], v] \mapsto [v_1 \cdots v_n] v
	\] 
	It is clear that this is well defined, linear, smooth and preserves the
	fiber. The map is injective because $v_1,\ldots,v_n$ must be linearly
	independent, and surjective because $v_1,\ldots,v_n$ is a basis for $E_x$.
\end{proof}
% p104 MQformula
% cordes pg 103
Let $E\to M$ be an oriented vector bunde or rank  $n$ with a
metric and compatible connection, and fiber $V$. 
Let $P=\Fr_{\SO}(E)$, so 
$E$ can be identified as the associated bundle $P\times_G V$ with the
induced connection. 
Denote $G=\SO(V)$, and its Lie algebra as $\mathfrak{g}=\mathfrak{so}(n)$.

The Weil homomorphism $w: W(\mathfrak{g}) \to \Omega(P)$ associated to the 
connection on $P$ induces a map $\overline{w}$ 
\begin{comment}
	
% https://q.uiver.app/?q=WzAsNixbMSwwLCJXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpIl0sWzIsMCwiXFxPbWVnYShQXFx0aW1lcyBWKSJdLFsxLDEsIihXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpKV97YmFzfSJdLFsyLDEsIlxcT21lZ2EoUFxcdGltZXMgVilfe2Jhc30iXSxbMywxLCJcXHNpbWVxXFxPbWVnYShFKSJdLFswLDEsIlxcT21lZ2FfRyhWKVxcc2ltZXEiXSxbMCwxLCJ3Il0sWzAsMl0sWzEsM10sWzIsMywidyJdXQ==
\[\begin{tikzcd}[column sep=2.2em]
		&[-34pt] {W(\mathfrak{g})\otimes\Omega(V)} & {\Omega(P\times V)} \\
	{\Omega_G(V)\simeq} &[-34pt] {(W(\mathfrak{g})\otimes\Omega(V))_{bas}} &
			{\Omega(P\times V)_{bas}} &[-34pt] {\simeq\Omega(E)}
				\arrow["w", from=1-2, to=1-3]
					\arrow[from=1-2, to=2-2]
						\arrow[from=1-3, to=2-3]
							\arrow["w", from=2-2, to=2-3]
\end{tikzcd}\]
\end{comment}
% https://q.uiver.app/#q=WzAsNyxbMSwwLCJXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpIl0sWzMsMCwiXFxPbWVnYShQXFx0aW1lcyBWKSJdLFsxLDEsIihXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpKV97YmFzfSJdLFszLDEsIlxcT21lZ2EoUFxcdGltZXMgVilfe2Jhc30iXSxbNCwxLCJcXHNpbWVxXFxPbWVnYShFKSJdLFswLDEsIlxcT21lZ2FfRyhWKVxcc2ltZXEiXSxbMiwwLCJcXE9tZWdhKFApXFxvdGltZXNcXE9tZWdhKFYpIl0sWzAsMl0sWzEsM10sWzIsMywiXFxvdmVybGluZXt3fSJdLFswLDYsInciXSxbNiwxLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dXQ==
\[\begin{tikzcd}[column sep=1em]
		&[-18pt] {W(\mathfrak{g})\otimes\Omega(V)} & {\Omega(P)\otimes\Omega(V)} 
		& {\Omega(P\times V)} \\
	{\Omega_G(V)\simeq} &[-18pt] {(W(\mathfrak{g})\otimes\Omega(V))_{bas}} &&
	{\Omega(P\times V)_{bas}} &[-18pt] {\simeq\Omega(E)}
				\arrow[from=1-2, to=2-2]
					\arrow[from=1-4, to=2-4]
						\arrow["{\overline{w}}", from=2-2, to=2-4]
							\arrow["w", from=1-2, to=1-3]
								\arrow["i",hook, from=1-3, to=1-4]
\end{tikzcd}\]
A few remarks are necessary to explain the diagram.
\begin{itemize}
\item 
	Here $W(\mathfrak{g})\otimes \Omega(V)$ is a tensor product of two
	$\mathfrak{g}$-differential graded algebras, where $V$ is considered as
	a $\SO(n)$-manifold. 

\item 
Since  $P\times V \to P\times_G V \simeq E$ is a principal bundle,
$\Omega^*(E)\simeq \Omega^*(P\times V)_{bas}$ by definition of basic forms.

\item 
The injection $i:\Omega(P)\otimes\Omega(V) \to \Omega(P\times V)$ can be defined
as follows. Denote by $p_1 : P\times V \to P$ and $p_2:P\times V \to V$ the 
canonical projections. Then the map is defined by $\omega \otimes \alpha
\mapsto p_1^*\omega \wedge p_2^*\alpha$.  

\item 
Since $w$ is a  $\mathfrak{g}$-dga morphism, so is  
$w:\Omega(\mathfrak{g})\otimes\Omega(V)\to \Omega(P)\otimes\Omega(V)$ because it
is the identity on  $\Omega(V)$. We claim that $i$ is also a $\mathfrak{g}$-dga morphism. 
\begin{itemize}
	\item Graded algebra homomorphism. It is linear by construction. It also respects
		multiplication because 
	\begin{align*}
		i((\omega_1\otimes\alpha_1)(\omega_2\otimes\alpha_2))
		&= i((-1)^{\abs{\alpha_1}\abs{\omega_2}}
		(\omega_1\wedge\omega_2)\otimes(\alpha_1\wedge \alpha_2)) \\
		&= (-1)^{\abs{\alpha_1}\abs{\omega_2}}
		p_1^*(\omega_1\wedge\omega_2)\wedge p_2^*(\alpha_1\wedge \alpha_2) \\
		&= (-1)^{\abs{\alpha_1}\abs{\omega_2}}p_1^*\omega_1\wedge
		p_1^*\omega_2\wedge p_2^*\alpha_1\wedge p_2^*\alpha_2  \\
		&= p_1^*\omega_1\wedge p_2^*\alpha_1 \wedge p_1^*\omega_2\wedge p_2^*\alpha_2 \\
		&= i(\omega_1\otimes \alpha_1)\wedge i(\omega_2\otimes \alpha_2) 
	\end{align*}
	\item Commutes with $d$ and $\iota_X$. This follows from by expanding the
		definitions of $d$ and  $\iota_X$ on the tensor product, given in
		equations (\ref{eq:tensor_ops}), and the fact that the pullbacks
		$p_1^*$ and $p_2^*$ commute with  $d$ and $\iota_X$.
\end{itemize}
Therefore, $w \circ i$ is a $\mathfrak{g}$-dga morphism and descends to the map
 $\overline{w}$ on the basic subcomplexes.
\end{itemize}


\begin{defn} 
	A form $U\in (W(\mathfrak{g})\otimes \Omega_{cv}(V))_{bas}$ is a
	\underline{universal Thom form} in the Weil model if for any oriented vector
	bundle $E$ of rank $n$ with a metric and compatible connection, the 
	Weil homomorphism $\overline{w}$ carries $U$ to a form representing the Thom class of $E$.
\end{defn} 

\begin{prop} 
	A differential form $U\in (W(\mathfrak{g})\otimes \Omega_{cv}(V))_{bas}$ is a 
	universal Thom form if and only $U$ is closed and  $\int_V U = 1$.
\end{prop}
\begin{proof}
	Denote $\overline{U}\in \Omega(P\times V)_{bas}$ to be the image of the
	Weil homomorphism $\overline{w}$. Then $\overline{U}$ will be closed because
	$\overline{w}$ is commutes with the differential operators. 

	It only remains to check that integration along the fiber gives 1. 
	This is defined on $\Omega(P\times_G V)\simeq \Omega(E)$ in exactly the same
	way, since coordinate functions on $E$ can be pulled back via the canonical
	isomorphism to coordinate functions on $P\times_G V$. 
	\begin{comment}
	Recall that a local trivialisation 
	$\phi_\alpha : E|_{U_\alpha} \to U_\alpha \times
	\mathbb{R}^n$ gives coordinate functions $[t_1\cdots t_n] = p_2\phi_\alpha
	\in \mathbb{R}^n$ where $p_2$ is the projection on to $\mathbb{R}^n$.  
	This can be identified with coordinate functions on the associated bundle
	$[x_1\cdots]$
	\end{comment}
	% TODO 
	(check integral is 1)
\end{proof}

\begin{prop} \label{prop:universal_Thom}
	The element $U \in W(\mathfrak{g}) \otimes \Omega(V)$ defined by  
	\[% cordes eq11.12
		U = (2\pi)^{-m} \Pf(\phi) \exp(-\abs{x}^2-\gen{\nabla x,\phi^{-1}\nabla x})
	\] 
	\[ % cordes eq 11.13
	U = \pi^{-m} e^{-\abs{x}^2}
	\int^B\exp(\frac{1}{4}\gen{\chi,\phi\chi}_{V^*}+i\gen{\nabla x, \rho})
	\odif{\rho}	
	\]
	\[%MQformula eq 6.2
	U = (2\pi)^{-m}\Pf(\Omega) \exp(-x^2-(dx+\theta x)^\intercal \Omega^{-1}
	(dx+\theta x))
	\] 
	is a universal Thom form in the Weil model.	
\end{prop}
	
 
% TODO prove equivalence to usual form
Applying the Weil-Cartan isomorphism $(W(\mathfrak{g})\otimes \Omega(V))_{hor}
\xrightarrow{\simeq} S(\mathfrak{g}^*)\otimes \Omega(V)$, we obtain a universal Thom form in the
Cartan model. 
\begin{prop}
	The form $U\in S(\mathfrak{g}^*)\otimes \Omega(V)$ given by 
	\[ % AJ 2.1
	U = \pi^{-m}e^{-x^2} \int^B \exp \paren{\frac{1}{4}\chi^{\intercal}\Omega\chi +
	idx^{\intercal}\chi} \odif{\chi} 
	\]
	is a universal Thom form in the Cartan model.
	where $x=(x_1,\ldots,x_{2m})$ are coordinates for $V=\mathbb{R}^{2m}$ and
	$\chi=(\chi_1,\ldots,\chi_{2m})$ are Grassman variables. Here $\Omega_{ij} \in
	\mathfrak{g}$ is defined as the image of the representation: $\Omega_{ij}(X) =
	\rho(X)_{ij}$. Note that we denote $\rho$ also as the induced representation on
	the Lie algebra.
\end{prop}
 
 

	The Mathai-Quillen Thom form in the Cartan model can be written in the
	alternative form
	\[% MQformula eq 1.8
	U = (2\pi)^{-m} \Pf(\Omega) \exp(-x^2-dx^{\intercal}\Omega^{-1}dx)
	\] 



\vspace{5mm}
\hrule 
\vspace{5mm}

\textbf{Bibliographical notes}
{\small
\begin{itemize}
	\item A more comprehensive treatment of the Thom isomorphism can be found in
		\citet{bott_tu}.  
\end{itemize}
}
