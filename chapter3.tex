
\chapter{Mathai-Quillen formula}
\label{chapter3}
The Mathai-Quillen formula is an explicit differential form representative of 
the Thom class of a vector bundle. The significance of the Thom class is 
that its pullback to the base manifold gives a representative of the Euler
class, thus it can be used to calculate the Euler number.  
Recall that there are two quite different approaches for calculating the Euler number
$\chi(X) = \chi(TX)$ of an oriented even dimensional manifold $X$. 
This first is topological, and counts
the signed isolated zeros of a vector field on $X$, via the Poincar\'e-Hopf theorem. The
second is differential geometric and represents  $\chi(X)$ as the integral over
$X$ of a density constructed from the curvature of a connection on $X$, via
the Gauss-Bonnet theorem. 
The Mathai-Quillen representative of the class depends on both a section $s$ and 
connection  $\nabla$ on the vector bundle, and can be regarded as a formula 
which interpolates between the two approaches.  

Our interest in the formula is further motivated by its application in providing a
geometric interpretation of the action principle of Witten's TQFT, where he
characterised Donaldson invariants as correlation functions of observables, as
we will see later in Chapter \ref{chapter4}. 

\section{Integration along the fiber} \label{section:fiber_integration}
Let $\pi: E\to B$ be an oriented fiber bundle over a manifold $B$ with oriented
fiber $F$. Suppose $\dim F = m$ and $\dim B = n$.
\begin{defn}
	\underline{Integration along the fiber} is a map $\pi_* : \Omega^*(E)\to
	\Omega^{*-m}(B)$, defined as follows. Let $\alpha\in \Omega^k(E)$ and
	$v_1,\ldots,v_{k-m} \in T_bB$ 
	\[
	(\pi_*\alpha)_b(v_1,\ldots,v_{k-m}) = \int_{\pi^{-1}(b)}
	\alpha(\widetilde{v}_1,\ldots,\widetilde{v}_{k-m},-)
	\] 
	where $\widetilde{v}_i$ is any lift of $v_i$ to $TE$. 
\end{defn}
The integral is computed by pulling back the form via a trivialisation $\phi 
:F \xrightarrow{\simeq} \pi^{-1}(b)$. 
To show that this is well defined, we need to check 
\begin{itemize}
	\item the integral is independent of choice of trivialisation
	\item definition is independent of the choices of lifts
	\item integrand is a smooth differential form on $\pi^{-1}(b)$
	\item $\pi_*\alpha$ is a smooth differential form on $B$
\end{itemize}
Denote $\beta = \alpha(\widetilde{v}_1,\ldots,\widetilde{v}_{k-m},-)$.\\
(1) Choice of trivialisation. This comes from the fact that the trivialisation
is oriented: if $\phi_1,\phi_2 : F \to \pi^{-1}(b)$ are two trivialisations,
then $\psi:=\phi_1^{-1}\phi_2 : F \to F$ is an orientation preserving diffeomorphism. 
Hence, on an open subset $V_\alpha \subset F$ the integral is written in
coordinates as  
\[
\int_{V_{\alpha}} \phi_1^*\beta \odif{f_1}\ldots\odif{f_m} 
= \int_{V_\alpha} \psi^*\phi_1^*\beta  \odif{g_1}\ldots\odif{g_m}
\] 
where $g_i = \psi(f_i)$ are the transformed coordinate functions. Since
$\det(D\psi)=1$ by assumption, the two integrals are equal by the change of 
coordinates theorem. 

Moreover, for vector bundles and principal bundles, the definition is also 
independent of the choice of oriented trivialisation with the same orientation. 
Even if $\phi_1,\phi_2$ are taken from different trivialisations, the
transition function $\phi_1^{-1}\phi_2: F \to F$ will be an orientation
preserving diffeomorphism due to the extra structure on $\phi_1$ and
$\phi_2$, i.e. linear isomorphism or $G$-equivariant map. 

(2) Choice of lifts. Fix $a\in \pi^{-1}(b)$, and let $\widetilde{v}_1'$ be 
another lift of $v_1\in T_bB$. That is, 
$D\pi|_a(\widetilde{v}_1)=D\pi|_a(\widetilde{v}_1')=v_1$. So
$\widetilde{v}_1'-\widetilde{v}_1\in \ker D\pi|_a = T_a(p^{-1}(b))$.  

Since the fiber dimension is $m$, $m+1$ vectors 
$w_1,\ldots,w_m,\widetilde{v}_1'-\widetilde{v}_1 \in T_a(\pi^{-1}(b))$ are
linearly dependent, and therefore 
\[
\alpha(\widetilde{v}_1'-\widetilde{v}_1,
\widetilde{v}_2,\ldots,\widetilde{v}_{k-m},w_1,\ldots,w_m) = 0
\] 
which shows the integrand is independent of the choice of lifts.

(3) Integrand is smooth on $\pi^{-1}(b)$. Since $\alpha$ is a smooth 
differential form, we only need to check that its dependence on the lifted 
vectors is smooth. Given a local trivialisation $\phi : U\times F
\xrightarrow{\simeq} \pi^{-1}(U)$, at $a\in\pi^{-1}(b)$ we can choose the lift 
$\widetilde{v}_1 = D\phi|_{\phi^{-1}(a)}(v_1)$. This is a smooth choice, and
hence $\alpha$ is smooth by part (2). 

(4) $\pi_*\alpha$ is a smooth differential form on $B$. To see this, we can
write it out in coordinates. Let 
$dx_1,\ldots,dx_{n},dt_1,\ldots,dt_m \in T^*E|_U$ be a basis, where
$t_i$ are coordinate functions for $F$ and $x_i$ are coordinate functions for
$B$. Assume $\alpha$ is a product of 1-forms and has a factor of 
$dt_1\wedge \cdots\wedge dt_m$, since
otherwise $\beta$ will not be a top form on $\pi^{-1}(b)$. Then integration
along the fiber is locally described by 
\[
\alpha = \pi^*\eta \wedge f(x,t) \odif{t_1}\cdots \odif{t_m}   
\mapsto \eta\wedge \int_{\pi^{-1}(b)} f(x,t) \odif{t_1}\cdots \odif{t_m}
\] 
for some $\eta\in \Omega(B)$. It is now apparent that the dependence on $x$,
i.e. the coordinates for  $B$, is smooth. 
\begin{remark}
	Note that not all differential forms in $\Omega^*(E)$ are integrable, 
	so we typically restrict $\pi_*$ to forms which
	are compactly supported, compactly supported along the fiber, or rapidly
	decreasing. 
\end{remark}
In this chapter, we are interested in integration along the fiber for oriented
vector bundles in particular, however the general definition will be needed
later when we integrate over $G$-orbits of principal bundles. The case of vector
bundles is slightly simpler, because the fiber has global coordinates. 
\begin{prop} % Bott Tu p62
	Integration along the fiber $\pi_*$ commutes with the exterior derivative
	$d$.
\end{prop}
\begin{proof}
	Since $\pi_*$ and  $d$ are linear,
	it suffices to prove this proposition on the restriction $E|_U \simeq
	U\times F$ to a subset in the trivialising open cover. If $\omega\in
	\Omega_{cv}^*(E)$, to write it in coordinates we need to further choose a
	subset $U\times V$ which is diffeomorphic to an open neighbourhood of
	$\mathbb{R}^{n+m}$. Then
	we can write it locally as $\omega = \pi^*\eta \wedge f(x,t) dt_1\cdots
	dt_n$ for some $\eta\in \Omega^*(B)$. Then 
	\begin{align*}
		d\pi_*\omega
		&= d \paren{\eta\wedge \int f(x,t)\odif{t_1}\cdots\odif{t_m} } \\
		&= d\eta\wedge\int f(x,t)\odif{t_1}\cdots\odif{t_m}  
		+\eta\wedge \sum_i dx_i\int \partial_{x_i} f(x,t)\odif{t_1}\cdots\odif{t_m} 
	\end{align*}
	and 
	\begin{align*}
		\pi_*d\omega
		&= \pi_*\paren[2]{\pi^*d\eta\wedge f(x,t) dt_1\cdots
		dt_n + \pi^*\eta \wedge\sum_i \partial_{x_i}f(x,t) dx_i dt_1\cdots
		dt_n } \\
		&= d\eta\wedge\int f(x,t)\odif{t_1}\cdots\odif{t_m} + \eta \wedge
		\sum_i dx_i\int \partial_{x_i} f(x,t)\odif{t_1}\cdots\odif{t_m} 
	\end{align*}
	where we have used $d\pi^*\eta = \pi^*d\eta$ in the first line. The proof is
	concluded by summing over the partition of unities subordinate to
	trivialising covers of $F$ and $E$.
\end{proof}
Therefore, $\pi_*$ descends to a well defined map on de Rham cohomology. 
Integration along the fiber can also be defined by the property (b) in the
following proposition, where the existence of $\pi_*\alpha$ can be seen as a 
generalisation of Fubini's theorem.
\begin{prop}[Projection formula] %  Bott Tu Prop 6.15 p63, BGV 1.15
	\label{prop:projection_formula}
	Let $\pi : E \to B$ be a fiber bundle with  $m$-dimensional fiber $F$, and
	both $B$ and  $E$ are oriented. 
	\begin{enumerate}[(a), leftmargin=\parindent]
	    \item For $\alpha\in \Omega_{cv}(E)$ and $\beta\in\Omega(B)$, 
	\[
		\beta\wedge \pi_*\alpha = \pi_*(\pi^*\beta\wedge\alpha)  
	\] 
		\item If $\alpha \in \Omega_{cv}(E)$ and $\beta\in \Omega_{c}(B)$,
			\[
			\int_B \beta\wedge \pi_*\alpha =  \int_E \pi^*\beta\wedge\alpha
			\] 
	\end{enumerate}
\end{prop}
\begin{proof}
	(a) Write $\alpha = \pi^*\eta \wedge f(x,t) dt_1\wedge\cdots\wedge dt_m $
	in terms of local coordinates on $E|_U$. Then 
	\[
	\pi_*(\pi_*\beta\wedge \alpha)
	=\pi^*(\beta\wedge\eta)\wedge \int_{\pi^{-1}(b)}f(x,t) 
	dt_1\wedge\cdots\wedge dt_m 	
	= \beta\wedge\pi_*(\alpha)
	\] 
	(b) Again, it suffices to prove this on the restriction $E|_U\simeq U\times F$ to a
	subset in the trivialising open cover of $E$. Furthermore,
	let $U\times V_\alpha$ be a trivialising open cover of $U\times F$, 
	where $U$ and each $V_{\alpha}\subset F$ are diffeomorphic to an open subset of
	$\mathbb{R}^d$. After summing over the partition of unity
	subordinate to an open cover of $E$, 
	the result will still hold. On $E|_U$, the integral can be written
	\begin{align*}
		\int_{E|_U} \pi^*\beta\wedge \alpha
		&= \sum_\alpha\int_{U \times V_\alpha}\pi^*\beta\wedge \alpha \\
		&= \sum_\alpha\int_{U}\int_{V_\alpha}\pi^*\beta\wedge \alpha
		= \int_{U}\int_{\pi^{-1}(b)}\pi^*\beta\wedge \alpha
		= \int_{U}\beta\wedge \pi_*\alpha 
	\end{align*}
	where we have applied Fubini's theorem in the second line, and the result of
	part (a) in the last equality.
\end{proof}


\section{Thom isomorphism}
\begin{thm}[Poincar\'e duality {\cite[p.44]{bott_tu}}] 
	\label{thm:poincare_duality}
	If $M$ is a compact orientable manifold of dimension $n$, then the pairing 
	\[
	\int_M : H^q(M)\otimes H_c^{n-q}(M) \to \mathbb{R}
	\] 
	is non-degenerate. Equivalently, $H^q(M)\simeq (H^{n-q}_c(M))^*$
\end{thm}
% In fact, the compactness assumption on $M$ is not necessary.
Consider a vector bundle $E\to M$ of rank  $n$, over a manifold of dimension $m$. 
Since the zero section embeds
$M$ diffeomorphically in  $E$, $M$ is a deformation retract of  $E$. Since
homotopic maps induce the same map in de Rham cohomology, it follows that
\[
H^*(E) \simeq H^*(M)
\] 
If we further assume $E$ and  $M$ are orientable manifolds, and $M$ is
compact, then a similar statement also holds for compact cohomology using 
Poincar\'e duality % Bott Tu pg 60
\[
H^*_c(E) \simeq (H^{n+m-*}(E))^* \simeq (H^{n+m-*}(M))^* \simeq H^{*-n}_c(M)
\] 
The Thom isomorphism is concerned with compact vertical cohomology: the chain
complex of forms with compact support along the fiber $\Omega_{cv}^*(E)$. An
$n$-form  $\omega$ is in $\Omega_{cv}^*(E)$ if for every compact set $K \subset M$, 
$\pi^{-1}(K)\cap \supp(\omega)$ is compact in $E$. 
From the previous section, integration along the fiber descends to a map 
on compact vertical cohomology
$\pi_* : H_{cv}^*(E) \to H^*(M)$. In fact, we can show that it induces an
isomorphism, called the Thom isomorphism.
We first prove this in the trivial bundle case $M\times \mathbb{R}^n \to M$.
\begin{prop} % Bott Tu Prop 6.16 
	Integration along the fiber defines an isomorphism
	\[
	\pi_* : H_{cv}^*(M\times \mathbb{R}^n) \to H^{*-n}(M)
	\] 
\end{prop}
\begin{proof} % p38 
	Let $\pi^n_* : H_{cv}^*(M\times \mathbb{R}^n) \to H_{cv}^{*-1}(M\times
	\mathbb{R}^{n-1})$ be integration along the last component of
	$\mathbb{R}^n$, and for ease of notation denote $H_{cv}^*(M\times
	\mathbb{R}^0) := H^*(M)$. We will prove that $\pi^n_*$ defines an
	isomorphism, because then the proposition follows by taking the composition
	$\pi_* = \pi^1_* \circ \cdots\circ \pi^n_*$ (using Fubini's theorem).

	Let $dt:=dt_1\wedge \cdots\wedge dt_n\in\Omega^n(\mathbb{R}^n)$ be the top 
	form corresponding to orthonormal coordinates on $\mathbb{R}^n$. 
	To produce a map in the reverse direction to $\pi^n_*$, let $e(t)dt \in
	\Omega^1_c(\mathbb{R})$ be a compactly supported $1$-form with integral 1,
	and define 
	\begin{align*}
	e_* : \Omega_{cv}^*(M\times \mathbb{R}^{n-1}) \to 
	\Omega^{*+1}_{cv}(M\times \mathbb{R}^n), \qquad  
	\omega \mapsto \omega \wedge e(t_n)\, dt_n 
	\end{align*}
	It is clear that $e_*$ commutes with  $d$, so induces a map on cohomology.
	Moreover,  $\pi_*^n \circ e_* = 1$ on  $\Omega_{cv}^*(M\times
	\mathbb{R}^{n-1})$. While $e_*\circ
	\pi_*^n \neq 1$ on the levels of forms, our strategy is to construct a
	homotopy operator  $K:\Omega^{*}(M\times \mathbb{R}^n) \to
	\Omega^{*-1}(M\times \mathbb{R}^n)$ such that 
	\begin{equation} \label{eq:homotopy_operator}
		1-e_*\pi_*^n = (-1)^{q-1}(dK-Kd), \qquad 
		\text{on } \Omega^q(M\times \mathbb{R}^n)
	\end{equation}
	This will imply that for any closed $\omega \in \Omega^*(M\times
	\mathbb{R}^n)$, $(1-e_*\pi_*^n)\omega$ is proportional to  $dK\omega$, 
	which is exact. Thus $e_*\pi_*^n=1$ on cohomology.
	Let $\omega \in \Omega^*(M\times \mathbb{R}^n)$. If $\omega$ does not 
	contain a factor of  $dt_n$, define $K(\omega) = 0$. Otherwise define 
	\[
		\omega = (\pi^*\phi) f(x,t) dt_I dt_n \mapsto 
		\pi^*\phi dt_I\paren[2]{\int_{-\infty}^t f \odif{t_n} 
		- \int_{-\infty}^t e \odif{t_n} \int_{\mathbb{R}} f \odif{t_n}}
	\] 
	where $I \subset \{1,\ldots,n-1\}$.
	It is now straightforward to prove equation (\ref{eq:homotopy_operator}):
	compute compare $(dK-Kd)\omega$ with $(1-e_*\pi_*^n)\omega$ for the cases 
	where $\omega$ contains a factor of $dt_n$ or not.
\end{proof}
The proof above shows that the inverse map in cohomology is given by the wedge
product with a compactly supported form $\Phi \in \Omega^{n}(\mathbb{R}^n)$ 
whose integral along each component is 1. This can be generalised to arbitrary 
vector bundles $E\to M$, known as the Thom isomorphism. 

\begin{thm}[Thom Isomorphism] % Thm 6.17 Bott Tu
	For a compact manifold $M$,
	integration along the fiber induces an isomorphism
	 $H^*_{cv}(E) \simeq H^{*-n}(M)$
\end{thm}
\begin{defn}
	Under the Thom isomorphism $H^*(M)\to H_{cv}^{*+n}(E)$, the
	image of $1\in H^0(M)$ is called the \underline{Thom class}  $\Phi\in
	H_{cv}^n(E)$ of the vector bundle.
\end{defn}
In other words, the representatives of the Thom class are precisely the forms
which are compactly supported along the fiber and have integral 1 along the
fibers.

% compact implies finite good cover = finite type 
% TODO generalise to non compact manifolds?

\section{Mathai-Quillen construction of Thom form}
\label{section:mq_formula}
The Mathai-Quillen construction uses a slight variation of the Thom isomorphism.
Differential forms with compact support in each fibre are replaced by forms
which are rapidly decreasing in the fibre directions. 

\begin{defn}
	Let $E\to M$ be a vector bundle with fiber  $V$ of rank  $n$.
	A differential form $\omega\in \Omega(E)$ is \underline{rapidly decreasing
	along the fiber} if the restriction to the fiber 
	$\omega_{\pi^{-1}(x)} : V \to \mathbb{R}$ is a Schwartz function for all $x\in M$,
	i.e.
	 \[
		 \fall a,b \in \mathbb{N}^n, \norm[*]{\omega_{\pi^{-1}(x)}}_{a,b} < \infty
	\] 
	where $\displaystyle \norm{f}_{a,b} := \sup_{x\in \mathbb{R}^n}\abs[*]{x^a(D^bf)(x)}$.
	The space of such forms is denoted $\Omega_{rd}(E)$.
\end{defn}

\vspace{-1ex}
Using the diffeomorphism $h : E \to E$ taking the unit ball to $\mathbb{R}^n$
\[
	h(y) = \frac{y}{\sqrt{1-\norm{y^2}} }
\] 
we can pull back a rapidly decreasing form $\omega\in \Omega_{rd}^*(E)$ to 
$\Omega_{cv}^*(E)$ which is supported on the unit ball bundle. 
Note that the Schwartz property guarantees that $h^*\omega$ is smooth, i.e. 
all derivatives approach zero as $y \to 1$ since $\omega$ decays faster than any
polynomial.


Let us first look at the construction on an oriented Euclidean vector bundle
$E\xrightarrow{\pi} M$ of rank $n$ over a point $M=\{x_0\}$. 
Given coordinates $x^1,\ldots,x^n$ on $E$ from the local trivialisation,
a Thom form $U\in \Omega^n_{rd}(E)$ can be defined as
\[
	U(x) = (2\pi)^{-n/2}e^{-\abs{x}^2 /2} dx^1\wedge \ldots\wedge dx^n
\] 
Given the basis $e_1,\ldots,e_n$ of  $V$ corresponding to the coordinates
$x^1,\ldots,x^n$, denote the map $dx = dx^k \otimes e_k \in 
\Omega^1(E, V)$. Then $e^{-idx}\in \Omega(E,\bigwedge V)$ by taking a formal sum
of wedge products.
We can express this form in terms of the Berezin integral,
considered as a map $\int^B := \int \odif{e_1}\cdots\odif{e_n} 
: \Omega^*(E,\bigwedge V) \to \Omega^*(E)$.

\begin{lem} \label{lem:gaussian_integral} %1.49 BGV
	The form $U\in \Omega^n_{cv}(E)$ equals 
	\[
		 U(x) = (2\pi)^{-n/2} e^{-\abs{x}^2 /2} \epsilon(n)\int^B e^{-idx}
	\] 
	where $\epsilon(n)=1$ if  $n$ is even, otherwise  $i$.
\end{lem}
\begin{proof}
	The Berezin integral kills any forms of order less than $n$, so only
	multiples of $e_1 \wedge \ldots\wedge e_n$ remain.
	Hence,
	\begin{align*}
		\int^B e^{-idx} 
		&= (-i)^n \frac{1}{n!}\int^B (dx^k\otimes e_k)^n \\
		&= (-i)^n \int^B (dx^1\otimes e_1) \ldots(dx^n\otimes e_n) \\
		&= (-i)^n(-1)^{n(n-1)/2} \int^B dx^1\wedge \ldots\wedge dx^n\otimes e_1 \wedge\ldots\wedge e_n \\
		&= (-i)^n(-1)^{n(n-1)/2} dx^1\wedge \ldots\wedge dx^n
	\end{align*}
	Multiplication of elements of $\Omega(E,\bigwedge V)$ occur in
	the graded tensor product, so that this is a graded algebra. 
	In the second line, we have permuted all $n!$ terms into standard order, and
	terms of degree two commute.
	In the third line, $dx^i$ are separated from the  $e_i$, which
	anti-commute due to  $\Omega(E,\bigwedge V)$ being a graded algebra. 
	The lemma now follows, since
	$(-i)^n(-1)^{n(n-1)/2}$ equals 1 if $n$ is even, and otherwise  $-i$. 
\end{proof}
We will define the Thom form on a more general manifold by modification of the
above lemma. Denote $x \in \Omega^0(E,\pi^*E)$ as the \underline{tautological
section}, defined by $e\in E_p \mapsto e\in (\pi^*E)_{e} = E_{p}$.
Then choosing a Euclidean connection $\nabla^E$ on  $E$, we may replace  $dx$ by 
$\nabla^{\pi^*E} x \in \Omega^1(E,\pi^*E)$.

\begin{prop} \label{prop:derivative_berezin} %1.50 BGV
	If $\nabla$ is a metric connection on  $E$, this induces a covariant
	derivative on $\bigwedge E$. Then for any
	$\alpha\in\Omega(M,\bigwedge E)$, we have 
	\[
	d\int^B \alpha = \int^B \nabla\alpha
	\] 
\end{prop}
\begin{proof} 
	Given a non-vanishing section $\nu\in \Omega^1(M,\bigwedge^nE)$,
	the Berezin integral is given by the induced inner product on $\bigwedge E$
	with  $\nu$. Then  $\nabla$ induced on  $\bigwedge E$ is compatible with
	this inner product, and 
	\[
	d\gen{\nu,\omega} = \gen{\nabla \nu, \omega} + \gen{\nu, \nabla \omega}
	=\int^B \nabla\omega
	\] 
	where we have used the fact that $\nabla \nu = 0$, by definition of the
	Berezin integral on an oriented vector bundle with a metric connection.
\end{proof}

We will apply this proposition to the pullback vector bundle $\pi^*E \to E$, 
with induced connection $\nabla^{\pi^*E}=\pi^*\nabla^E$. Denote $V=\pi^*E$ to
simplify notation.
Let $\iota(s):\Omega^i(E,\bigwedge^j V) \to
\Omega^i(E,\bigwedge^{j-1} V)$ for $s\in\Gamma(V)$ be a contraction operator
defined in a similar fashion as \ref{def:contraction}, by the following
properties:
\begin{enumerate}[(1)]
    \item If $w\in \Omega^0(E,V)$, then  $\iota(s)w = \gen{s,w}$
	\item If $\alpha\in\Omega^i(E,\bigwedge^jV),
		\beta\in\Omega^k(E,\bigwedge^lV)$, then 
	 \[
	\iota(x)(\alpha\wedge \beta) 
	= (\iota(x)\alpha)\wedge\beta + (-1)^{i+j}\alpha\wedge(\iota(x)\beta)
	\] 
\end{enumerate}
Note that this uniquely defines $\iota(s)$ because the formulas can be applied
to a basis of $\bigwedge^iT^*E\otimes \bigwedge^jV$.

Denote $\nabla = \nabla^{\pi^*E}$. 
Recall that the curvature is a form in $\Omega^2(E,\End(V))$ 
which is skew-symmetric valued. We can identify $\mathfrak{so}(V)$ with 
$\bigwedge^2 V$ in the following way:
\begin{equation} \label{eq:so_wedge}
	A\in \mathfrak{so}(V) \mapsto \sum_{i<j} \gen{Ae_i,e_j} e_i\wedge e_j
\end{equation}
given a frame of $V$. Hence, we denote the curvature form as $F \in
\Omega^2(E,\bigwedge^2V)$.

\begin{prop} \label{prop:closed_prop} % 1.51 BGV
	Let $x \in \Omega^0(V)$ be the tautological section on $E$, and $\nabla$ the
	induced connection on $\bigwedge V$.
	Let $\omega_t = \frac{1}{2}t^2\abs{x}^2 + it\nabla x + F 
	\in \Omega(E,\bigwedge V)$. Then 
	\[
		(\nabla - it\iota(x))\omega_t = 0
	\] 
\end{prop}
\begin{proof}
	 By metric compatibility,
	$\nabla \abs{x}^2 = 2\gen{\nabla x, x} = -2\iota(x)\nabla x$.
	Next, we have $\nabla(\nabla x) = \iota(x) F$.
	Finally by Bianchi's identity, $\nabla F = 0$. Combining this,
	\[
	\nabla \omega_t = -t^2\iota(x) \nabla x + it\iota(x)F 
	\] 
	On the other hand, $\iota(x)\abs{x}^2 = 0$ by definition of $\iota(x)$, so
	\[
	it\iota(x)\omega_t = -t^2\iota(x) \nabla x + it\iota(x)F
	\] 
\end{proof}

We now define the Mathai-Quillen Thom form 
\begin{equation}
	U = (2\pi)^{-n/2}\epsilon(N) \int^B e^{-\frac{1}{2}\abs{x}^2-i\nabla x - F} \in \Omega^n(E)
\end{equation}
and its parameterised version $U_t = (2\pi)^{-n/2}\epsilon(N) \int^B e^{-\omega_t} \in
\Omega^n(E)$. To justify why $U_t\in\Omega^n(E)$, note that
$\omega_t\in\bigoplus_{i=0}^2 \Omega^i(E,\bigwedge^iV)$, and hence 
$e^{-\omega_t} \in \bigoplus_{i=0}^n \Omega^i(E,\bigwedge^iV)$. The Berezin
integral then only retains the top degree part. 

\begin{thm}
	The Mathai-Quillen form $U \in \Omega^n_{rd}(E)$ is a Thom form. 
\end{thm}
\begin{proof}
	% BGV Lemma 1.51
	We need to show that $U$ is closed, and integration along the fiber gives $1\in
	\Omega^0(E)$.
	From equation (\ref{eq:grassman_exp}), the exponential of $-\omega_t$
	can be written 
	\begin{equation} \label{eq:MQ_exp}
		e^{-\omega_t} = \sum_{k=0}^{n} \frac{e^{-t^2\abs{x}^2 /2}}{k!} (-it\nabla x
		- F)^k 
		= \sum_{k=0}^{\infty} \frac{1}{k!} (-\omega_t)^k
	\end{equation}
	Since $\nabla - it\iota(x)$ is an antiderivation, it follows from
	Proposition \ref{prop:closed_prop} that $(\nabla-it\iota(x)) e^{-\omega_t} =
	0$. 
	We can extend Proposition \ref{prop:derivative_berezin} to 
	$d\int^B\alpha = \int^B (\nabla-it\iota(s))\alpha$ for any	
	$\alpha\in\Omega(\bigwedge V)$ since $\iota(s)\alpha$ has no component in 
	the top exterior power.	
	Therefore it follows that $U_t \propto \int^B e^{-\omega_t}$ is closed.
	
	% BGV prop 1.52 says integral reduces to the case where $M$ is a point
	% Proof is found from Blau 
	From equation (\ref{eq:MQ_exp}), we can write the Thom form as 
	\[
	U_t = (2\pi)^{-n/2}\epsilon(N) e^{-\frac{1}{2}\abs{x}^2}\int^B e^{-i\nabla x -F}
	\] 
	To integrate $U_t \in \Omega(E)$ along the fiber of $V=\pi^*E$, we extract from
	the Berezin integral the part which is a $n$-form on the fiber of $V$,
	\begin{align*}
		\int_E (2\pi)^{-n/2}\epsilon(N) e^{-\frac{1}{2}\abs{x}^2}\int^B e^{-i\nabla x -F}
		&= (2\pi)^{-n/2}\epsilon(N) \int_E e^{-\frac{1}{2}\abs{x}^2}\int^B 
		e^{-idx}
		= 1 
	\end{align*}
	we are only left with the $dx$ term because the induced connection and
	curvature forms on  $\pi^*E$ do not have any components along the fiber.
	We have evaluated the integral using Lemma \ref{lem:gaussian_integral}.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment} % Blau approach
Let $E=P\times_\rho V$ be the associated bundle to $P$ with rank $2m$. 
basic forms on $P\times V$ are in correspondence with forms on  $E$.

A representative for the Thom class, called the Mathai-Quillen Thom form, is
given by
\begin{equation} \label{eq:mathai_quillen}
\Phi_\nabla(E) = \frac{1}{(2\pi)^m} e^{-v_a^2/2} \int \odif{\chi} 
\exp(\chi_a\Omega^{ab}\chi_b /2 + i\nabla v^a \chi_a)
\end{equation}
where $v^a \in \Omega^0(P\times V)$ are coordinates on $V$, and $\nabla v^a \in
\Omega^1(P\times V)$ is the exterior covariant derivative of $v^a$.
Not well defined globally, since using trivialisation to use coordinates? 

We claim that this defines a basic form in $\Omega^{2m}_\rho(P\times V)$,
and that it is a representative of the Thom class. 

To show that it is a basic form, we need to prove it is horizontal and $\rho$
equivariant.  

To show that is is a representative of the Thom class, we need to prove it is
closed and satisfies  $\pi^*\Phi_\nabla(E) = 1$.

Pullback by zero section is Pfaffian.
\end{comment} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prop} % prop 1.53 BGV
	We have the transgression formula
	\[
	\odv{}{t} U_t = -i\epsilon(N) d\int^B x e^{-\omega_t}
	\] 
\end{prop}
\begin{prop} \label{prop:thom_pullback}
	Let $s\in \Gamma(M,E)$ be a section of $E$.
	The cohomology class of the pullback $s^*\Phi_\nabla(E) \in \Omega^{n}(M)$
	is independent of the section  $s\in\Gamma(E)$.
\end{prop}
\begin{proof}
	Integrating the transgression formula above from 0 to 1, 
	\[
		U_1 - U_0 = -id\int_0^1\int^B x e^{-t^2\abs{x}^2/2 +
		it\nabla x + F} \odif{t}
	\] 
	Note that $s^*U_0 = \epsilon(n)\int^B e^{-s^*F} \in \Omega(M)$. Since $F$ is
	the pullback curvature on $V = \pi^*E$, it is constant on 
	(why is $s^*U$ equal to the Pfaffian? use basis of V).

	Taking the pullback by $s$ on both sides, we find that $s^*U_1$ is
	cohomologous to the Euler class for any section $s$:  
	\[
		s^*U_1 - s^*U_0 = -id\int_0^1\int^B s\wedge e^{-t^2\abs{s}^2/2 +
		it\nabla s + F} \odif{t}
	\] 
	% TODO: complete proof
\end{proof}



\section{Universal Mathai-Quillen formula}
\begin{prop}
	Let $E\to M$ be an oriented vector bundle with fiber $V=\mathbb{R}^n$ 
	and  $P=\Fr_{\SO}(E)$ be the
	principal $\SO(n)$-bundle of orthonormal oriented frames on  $E$. Then 
	$P\times_{\SO(n)} V$ is canonically isomorphic to $E$ as a vector bundle. 
\end{prop} 
\begin{proof}
	The action of $A\in\SO(n)$ on $P\times V$ is 
	$
		([v_1 \cdots v_n], v) \cdot A = ([v_1 \cdots v_n] A, A^{-1} v) 
	$.
	Then the canonical isomorphism $\psi : P\times_{\SO(n)} V \to E$ is defined by
	\[
		[[v_1 \cdots v_n], v] \mapsto [v_1 \cdots v_n] v
	\] 
	It is clear that this is well defined, linear, smooth and preserves the
	fiber. The map is injective because $v_1,\ldots,v_n$ must be linearly
	independent, and surjective because $v_1,\ldots,v_n$ is a basis for $E_x$.
\end{proof}
% p104 MQformula
% cordes pg 103
Let $E\to M$ be an oriented vector bunde or rank  $n$ with a
metric and compatible connection, and fiber $V$. 
Then $E$ can be identified as the associated bundle $\Fr_{\SO}(E)\times_{\SO} V$ 
with the induced connection. 

More generally, consider a connected Lie group $G$ and 
principal $G$-bundle  $P\to M$ over a manifold of
dimension $n$ with a connection $\omega$. Let $\rho : G \to \SO(V)$ be a 
representation of rank $n$ (same as $\dim M$). 
This determines the associated vector bundle  $E:=P\times_\rho V \to M$
with typical fiber $V$. 

% Sources for this:
% naber p113
% guillemin 7.2, ch10
% constantinescu 2.2
Let $p_1,p_2$ be the projection maps from $P\times V$ to  $P$ and  $V$
respectively. Note that both maps are $G$-equivariant, where 
$V$ is considered as a $G$-manifold with action $v\cdot g = \rho(g)^{-1} v$.
The principal bundle $P\times V \to P\times_\rho V$ has the connection 
$p_1^*\omega$ (the reader should check this is a valid connection).
The Cartan map associated to this 
connection gives the homomorphism
\[
	\Omega_G(V) \xrightarrow{p_2^*} \Omega_G(P\times V) 
	\xrightarrow{\operatorname{Car}_{\omega}} \Omega(P\times V)_{bas}\simeq
	\Omega(E)
\] 
given by $\alpha \mapsto \operatorname{Hor}_{\omega}((p_2^*\alpha)(\Omega))$. 
Since  $P\times V \to E$ is a principal bundle,
$\Omega^*(E)\simeq \Omega^*(P\times V)_{bas}$ by definition of basic forms on a
principal bundle.

\begin{comment}
% as a composition with inclusion in top row
% https://q.uiver.app/#q=WzAsNyxbMSwwLCJXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpIl0sWzMsMCwiXFxPbWVnYShQXFx0aW1lcyBWKSJdLFsxLDEsIihXKFxcbWF0aGZyYWt7Z30pXFxvdGltZXNcXE9tZWdhKFYpKV97YmFzfSJdLFszLDEsIlxcT21lZ2EoUFxcdGltZXMgVilfe2Jhc30iXSxbNCwxLCJcXHNpbWVxXFxPbWVnYShFKSJdLFswLDEsIlxcT21lZ2FfRyhWKVxcc2ltZXEiXSxbMiwwLCJcXE9tZWdhKFApXFxvdGltZXNcXE9tZWdhKFYpIl0sWzAsMl0sWzEsM10sWzIsMywiXFxvdmVybGluZXt3fSJdLFswLDYsInciXSxbNiwxLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dXQ==
\[\begin{tikzcd}[column sep=1em]
		&[-18pt] {W(\mathfrak{g})\otimes\Omega(V)} & {\Omega(P)\otimes\Omega(V)} 
		& {\Omega(P\times V)} \\
	{\Omega_G(V)\simeq} &[-18pt] {(W(\mathfrak{g})\otimes\Omega(V))_{bas}} &&
	{\Omega(P\times V)_{bas}} &[-18pt] {\simeq\Omega(E)}
				\arrow[from=1-2, to=2-2]
					\arrow[from=1-4, to=2-4]
						\arrow["{\overline{w}}", from=2-2, to=2-4]
							\arrow["w", from=1-2, to=1-3]
								\arrow["i",hook, from=1-3, to=1-4]
\end{tikzcd}\]

A few remarks are necessary to explain the diagram.
\begin{itemize}
\item 
The injection $i:\Omega(P)\otimes\Omega(V) \to \Omega(P\times V)$ can be defined
as follows. Denote by $p_1 : P\times V \to P$ and $p_2:P\times V \to V$ the 
canonical projections. Then the map is defined by $\omega \otimes \alpha
\mapsto p_1^*\omega \wedge p_2^*\alpha$.  

\item 
Since $w$ is a  $\mathfrak{g}$-dga morphism, so is  
$w:\Omega(\mathfrak{g})\otimes\Omega(V)\to \Omega(P)\otimes\Omega(V)$ because it
is the identity on  $\Omega(V)$. We claim that $i$ is also a $\mathfrak{g}$-dga morphism. 
\begin{itemize}
	\item Graded algebra homomorphism. It is linear by construction. It also respects
		multiplication because 
	\begin{align*}
		i((\omega_1\otimes\alpha_1)(\omega_2\otimes\alpha_2))
		&= i((-1)^{\abs{\alpha_1}\abs{\omega_2}}
		(\omega_1\wedge\omega_2)\otimes(\alpha_1\wedge \alpha_2)) \\
		&= (-1)^{\abs{\alpha_1}\abs{\omega_2}}
		p_1^*(\omega_1\wedge\omega_2)\wedge p_2^*(\alpha_1\wedge \alpha_2) \\
		&= (-1)^{\abs{\alpha_1}\abs{\omega_2}}p_1^*\omega_1\wedge
		p_1^*\omega_2\wedge p_2^*\alpha_1\wedge p_2^*\alpha_2  \\
		&= p_1^*\omega_1\wedge p_2^*\alpha_1 \wedge p_1^*\omega_2\wedge p_2^*\alpha_2 \\
		&= i(\omega_1\otimes \alpha_1)\wedge i(\omega_2\otimes \alpha_2) 
	\end{align*}
	\item Commutes with $d$ and $\iota_X$. This follows from by expanding the
		definitions of $d$ and  $\iota_X$ on the tensor product, given in
		equations (\ref{eq:tensor_ops}), and the fact that the pullbacks
		$p_1^*$ and $p_2^*$ commute with  $d$ and $\iota_X$.
\end{itemize}
Therefore, $w \circ i$ is a $\mathfrak{g}$-dga morphism and descends to the map
 $\overline{w}$ on the basic subcomplexes.
\end{itemize}
\end{comment}

% def depends on next proposition
\begin{defn} 
	An element $U\in (S(\g^*)\otimes \Omega(V))^G$ is a
	\underline{universal Thom form} if for any principal $G$-bundle $P\to M$ 
	with a connection, a representation $\rho : G\to \SO(V)$ and oriented
	associated bundle $P\times_\rho V$, the
	Cartan map $\operatorname{Car}_{\omega} : \Omega_{G}(V) \to
	\Omega(P\times_\rho V)$
	carries $U$ to a form representing the Thom class of $P\times_\rho V$.

	\begin{comment}
	A form $U\in (S(\so(V)^*)\otimes \Omega_{cv}(V))^G$ is a
	\underline{universal Thom form} if for any oriented vector
	bundle $E$ of rank $n$ with a metric and compatible connection, the 
	Cartan map $\operatorname{Car}_{\omega} : \Omega_{\SO(V)}(V) \to \Omega(E)$
	carries $U$ to a form representing the Thom class of $E$.
	\end{comment}
\end{defn} 

The integral over $V$ for equivariant forms
is a map  $\int_V : S(\g^*)\otimes \Omega(V) \to S(\g^*)$ defined by 
$\paren{\int_V \alpha}(X) = \int_V \alpha(X)$, where elements of $S(\g^*)$ are 
viewed as  polynomials on $\g$. 

\begin{thm} 
	A differential form $U\in (S(\mathfrak{g}^*)\otimes \Omega(V))^G$ is a 
	universal Thom form if and only if $U$ is closed and  $\int_V U = 1$.
\end{thm}
\begin{proof}
	Assume we have the same objects as above.
	When we pull back the form on $\Omega(V)$ to $\Omega(P\times V)$, it
	will still be a basic element because the projection $p_2$ is 
	$G$-equivariant. Next, the image of    
	$w:(S(\g)^*\otimes \Omega(P\times V))^G \to \Omega(P\times V)_{inv}$ 
	will be closed because the Weil homomorphism
	commutes with the differential operators. Finally, its horizontal
	projection is also closed. The same argument
	in reverse proves that $U$ must be closed if  $\Car_\omega(p_2^*U))$ is
	closed.

	% guillemin p157
	It remains to check that integration along the fiber of
	$\tau:=\operatorname{Car}_{\omega}(p_2^*U)\in\Omega(E)$ equals the integral
	over  $V$ of the universal Thom form.
	Fix a point $x_0\in M$, let $P_0=\pi^{-1}(x_0)$ be the fiber over $x_0$
	and $E_0$ be the fiber of $E$ over  $x_0$. 
	The fiber integral of $\tau$ only depends on the value of $\tau$ at the
	tangent space of the fiber submanifold, i.e. in the vertical direction (see
	figure ???). 
	So to evaluate the fiber integral at any point in $E_0$, it suffices to 
	consider the restriction to the principal $G$-bundle 
	$P_0\times V \to E_0$.

	The tangent space at $(p,v)\in P_0\times V$ 
	is $V_pP \oplus V$. But the connection on $P\times V$ is the pullback 
	$p_1^*\omega$, which is constant in the $V$ direction, and the curvature
	form vanishes on  $V_pP\oplus V$ since it is also a horizontal form. 
	If $\alpha_1,\ldots,\alpha_d$ is a dual basis for
	$\g^*$, the element $p_2^*U$ is a sum of terms of the form 
	$\beta_I \alpha_I$, where  $\beta_I \in \Omega(P\times V)$ are invariant
	forms. 
	After we replace the $\alpha_i$ by the curvature forms  $\Omega_i$, as a
	form on $P_0\times V$ we are only left with the term $\beta_0$. 
	Then taking the horizontal component amounts to only evaluating tangent
	vectors in $V$ at each point $(p,v)\in P_0\times V$ (see figure ???). 
	Subsequently, the fiber integral is the same as the integral of 
	$\beta_0$ over $V$, which equals 1 because $\int_V U = 1$.  
	% TODO draw diagram showing fiber integral, submanifold, horizontal proj
	\begin{comment} % first attempt
	This is defined on $\Omega(P\times_G V)\simeq \Omega(E)$ in exactly the same
	way, since coordinate functions on $E$ can be pulled back via the canonical
	isomorphism to coordinate functions on $P\times_G V$. 
	Recall that a local trivialisation 
	$\phi_\alpha : E|_{U_\alpha} \to U_\alpha \times
	\mathbb{R}^n$ gives coordinate functions $[t_1\cdots t_n] = p_2\phi_\alpha
	\in \mathbb{R}^n$ where $p_2$ is the projection on to $\mathbb{R}^n$.  
	This can be identified with coordinate functions on the associated bundle
	$[x_1\cdots]$
	\end{comment}
\end{proof}

The above theorem is proved in chapter 10 of \cite{guillemin} in the more
general context of a $K$-manifold $E=P\times_\rho V$, and a principal
$G$-bundle  $P\times V \to P\times_\rho V$, with associated Cartan map
$\Car_\omega : \Omega_{G\times K}(P\times V)\to\Omega_K(E)$. The Thom form is
obtained from the map $\Car_{\omega}(p_2^*U)$ where $U\in\Omega_{G\times K}(V)$.

% Guillemin 7.2
We shall now construct the Mathai-Quillen universal Thom form.
Let $V$ be a real vector space with standard inner product, and $\rho : G \to
\SO(V)$ be a rep of the Lie group $G$, with induced rep $\rho_* :
\mathfrak{g}\to \so(V)$.
We will apply the Berezin integral to a form in $S(\mathfrak{g}^*)\otimes 
\Omega(V) \otimes \bigwedge V$. 
Fix an oriented orthonormal basis $\{e_1,\ldots,e_n\}$ for
$V$, which allows us to define the Berezin integral, with corresponding
coordinate functions $x_1,\ldots,x_n$.   
Let  $\{X_1,\ldots,X_m\}$ be a basis of $\mathfrak{so}(V)$, with corresponding
dual basis $\{u_1,\ldots,u_m\}$ where $m= \frac{1}{2}n(n-1)$. Recall that we 
can identify $\mathfrak{so}(V)$ with 
$\bigwedge^2 V$ via equation (\ref{eq:so_wedge}), restated here 
\[
	X_a \in\mathfrak{so}(V) \mapsto \sum_{i<j}\gen{X_a e_i,e_j} e_i\wedge e_j
	= \frac{1}{2}\sum_{i} e_i\wedge X_a e_i
\] 
Denote $dx := \sum_i dx_i \otimes e_i \in \Omega^1(V)\otimes V$. Define the element 
\begin{equation} % 7.16 guillemin % cordes eq 11.13 % naber 3.18
	\label{eq:universal_thom_exponent}
	\sigma := -\frac{1}{2}\abs{x}^2 - idx 
	- \sum_a u_a\rho_* \otimes X_a 
	\quad \in S(\g^*) \otimes \Omega(V) \otimes \bigwedge V
\end{equation}
which is analogous to $\omega_1$ as defined in Prop \ref{prop:closed_prop}.
Note that $u_a \rho_* \in \mathfrak{g}^*$.
In components, if $M^a = [\gen{ X_ae_i,e_j}]_{ji}$, we can write the same
element as 
\begin{equation} \label{eq:universal_thom_exponent2}
\sigma = -\frac{1}{2}\abs{x}^2 - i\sum_i dx_i\otimes e_i 
	-\frac{1}{2} \sum_{i,j} (\rho_*)_{ji}e_i\wedge e_j
\end{equation}
since $u_aX_a$ is the identity on  $\so(V)$, and $(\rho_*)_{ji} \in \mathfrak{g}^*$.
Consider its Berezin integral
\begin{equation} \label{eq:universal_thom}
	U := \epsilon(n)(2\pi)^{-n /2}\int^B \exp\paren{\sigma}  
	\quad\in S(\g^*)\otimes \Omega(V)
\end{equation}
where $\epsilon(n)=1$ if $n$ is even and otherwise $\epsilon(n)=i$.

\begin{thm} \label{thm:uinversal_Thom}
	The element $U \in S(\mathfrak{g}^*) \otimes \Omega(V)$ defined above  
	is a universal Thom form.
\end{thm}
\begin{proof} % Guillemin p86-87
We need to show that it is invariant and
equivariantly closed in the Cartan model, and integration along the
fiber gives 1. 


(1) Closed. 
We can consider the Cartan
differential $\delta_C = d - \sum u_k\iota_k$ as an operator on 
$S(\so(V)^*)\otimes\Omega(V)\otimes\bigwedge V$ by acting trivially on
the last factor, so that it commutes with the Berezin integral. 
It suffices to show $U$ is closed as a form on  $S(\so(V)^*)\otimes \Omega(V)$,
because the map  $\rho^* : S(\so(V)^*)\to S(\g^*)$ given by  $u_i\mapsto
u_i\circ \rho_*$ commutes with the Cartan differential. This can be seen most
easily by viewing the elements as polynomials as in Theorem
\ref{thm:cartan_diff}, which shows that  $(\delta_C \rho_* \alpha)(X) 
= (\rho_*\delta_C \alpha)(\rho(X)) = (d-\iota_{\rho(X)})\alpha(\rho(X))$, noting
that $\iota_X$ and  $\iota_{\rho(X)}$ act the same way on $\Omega(V)$.

For the first term, only $d$ acts to give $\delta_C \abs{x}^2 = 2x_i dx_i$.
On the second term, $d^2=0$ and we need to evaluate $u_a\iota_a dx_i$. 
Since $x_i$ projects to the $i$th component of a vector in $V$, and the action
of $e^{tX_k}$ is matrix multiplication, for $v\in V$ in the tangent space
\begin{align} \label{eq:interior_dx}
	\iota_a dx_i(v)
	= d x_i \paren{\odv{}{t}_{t=0} e^{-tX_a} v} 
	= -x_i \paren{X_a v} 
\end{align}
Hence, $u_a\iota_a dx_i = -u_a\otimes x_i \circ X_a$. The third term is a
multiple of $u_i$ and constant on $\Omega(V)$,
hence maps to zero by  $\delta_C$. Thus, 
\begin{align}
	(d-u_a\iota_a) \sigma 
&= -x_i dx_i - u_a \otimes i x_iX_a \otimes e_i \nonumber \\
&= -x_i dx_i - u_a \otimes i x_j \otimes X_a e_j 
\end{align}
which is justified by $x_j$ being the coordinate functions of $e_j$:
\begin{equation} \label{eq:move_operator_tensor}
x_i X_a \otimes e_i 
= \gen{X_ae_j,e_i}x_j \otimes e_i 
= x_j \otimes \gen{X_ae_j,e_i}e_i 
= x_j \otimes X_a e_j 
\end{equation}
The key observation is that $\delta_C$ acts by lowering the degree of the
$\bigwedge V$ part. More precisely, consider the action of the Berezin
derivative/integral
\begin{align*}
\pdv{}{e_k} \paren{-\sum_{i<j} u_a\otimes e_i\wedge M^a_{ji}e_j}
&= -\sum_{i>k} u_a\otimes M^a_{ik}e_i + 
 \sum_{i<k} u_a\otimes M^a_{ki}e_i \\
&= -\sum_{i} u_a\otimes M^a_{ik}e_i  
= -u_a\otimes X_a e_k  
\end{align*}
since $M^a_{ij}=-M^a_{ji}$. Applying $\pdv{}{e_k}$ to the other term,
\[
\pdv{}{e_k} (-idx_i \otimes e_i) = idx_k
\] 
because $e_i$ anti-commutes with  $dx_i$. We have shown that
\begin{equation}
\delta_C \sigma = \paren{\sum_{k} ix_k \pdv{}{e_k}}\sigma
\end{equation}
It follows that this also holds for $\exp (\sigma)$, because  $\delta_C$ is an
anti-derivation. Therefore, 
\[
\delta_C \int^B \exp(\sigma) 
= \int^B \delta_C \exp(\sigma)
= \int^B ix_k \pdv{}{e_k} \exp(\sigma) = 0
\] 
as the Berezin derivative kills any top degree terms in $\bigwedge V$.

(2) Integral along the fiber. We need to extract the coefficient of $dx_1\wedge
\ldots\wedge dx_n$. Therefore, the last term in $\sigma$ does not contribute,
and 
 \[
	 \int_V U = \epsilon(n)(2\pi)^{-n /2}\int_V e^{-\abs{x}^2} \int^B \exp(-idx_k \otimes e_k) 
\] 
But we know $\int^Be^{-idx_k\otimes e_k}$ evaluates to 
$(-i)^n(-1)^{n(n-1)/2} dx_1\wedge \ldots\wedge dx_n$ by Lemma
\ref{lem:gaussian_integral}. Hence, the integral of $U$ along the fiber $V$ is 1.

(3) Invariant. % proved in p27 Constantinecu PhD
It suffices to show the terms in $\sigma$ are invariant, because
the Lie derivative is a derivation. We can extend the action of $G$ to the
graded algebra $S(\g^*)\otimes \Omega(V)\otimes \bigwedge V$,
acting on the $\bigwedge V$ component by multiplication by $\rho(g)^{-1}$. 
Note that the Berezin integral is
invariant under the action on $\bigwedge V$. This gives an associated Lie derivative,
corresponding to multiplication by $\rho_*(X)$ for  $X\in\mathfrak{g}$.

It is clear that $\abs{x}^2$ is invariant, because $\rho(g)$ has determinant 1.
Next, we show $dx_i\otimes e_i$ is invariant by applying $\mathcal{L}_X$,
\[
\mathcal{L}_X (dx_i\otimes e_i) = \iota_X(dx_i) \otimes e_i + dx_i \otimes
\rho_*(X)e_i = 0
\] 
by equations (\ref{eq:interior_dx}) and (\ref{eq:move_operator_tensor}).
Finally, to apply $\mathcal{L}_X$, recall that the action on $S(\g^*)$ 
is the coadjoint representation $\mathcal{L}_X \alpha(Y) = -\alpha ([X,Y])$. 
The action on $V$ is  $\mathcal{L}_X v = \rho_*(X)v$.
We can denote the third term in $\sigma$
as $\frac{1}{2}e_i\wedge (\rho_*)_{ji} e_j \in \g^*\otimes \bigwedge^2V$,
since $u_aX_a$ is just the identity.
For $X,Y\in\g$, with  $\rho_*(X)=A,\rho_*(Y)=B$,
\begin{align*}
	&\quad\;(\mathcal{L}_X(e_i \wedge (\rho_*)_{ji} e_j))(Y) \\
	&= (A e_i \wedge \rho_* e_i)(Y)
	- e_i \wedge \rho_*([X,Y]) e_i
	+ (e_i \wedge \rho_* A e_i)(Y) \\
	&= Ae_i \wedge B e_i
	- e_i \wedge (AB-BA) e_i
	+ e_i \wedge A Be_i \tag{$\star$} \\
	&= -e_i \wedge BA e_i
	- e_i \wedge (AB-BA) e_i
	+ e_i \wedge AB e_i = 0\tag{$\star\star$}
\end{align*}
where we begin by using the derivation property of $\mathcal{L}_X$, and explain
the next two lines below.

Proof of ($\star$): This step initially looks wrong, but recall that the term is
to be interpreted as 
\[
\sum_{i,j}e_i\wedge (\rho_*(Y))_{ji} (Ae_j)
=\sum_{i,j}e_i\wedge \sum_kB_{ji} A_{kj}e_k
=\sum_{i}e_i\wedge \sum_{k,j}A_{kj}B_{ji} e_k
=\sum_{i}e_i\wedge AB e_i
\] 
Proof of ($\star\star$): This is just an application of the more general property
\[
Ae_i \wedge Be_i
= A_{ji}e_j \wedge B_{ki}e_k
= e_j \wedge B_{ki}A^\intercal_{ij}e_k
= e_j \wedge BA^\intercal e_j 
\] 
Finally, $U$ is invariant because $\mathcal{L}_X$ commutes with the Berezin
integral.
\end{proof}

The proof of (1) closure is due to \citet{guillemin} and part of (3) invariance
is a corrected version of the proof in \citet[p.27]{constantinescu}. In
particular, the steps $(\star)$ and  $(\star\star)$ are corrected, as well as
the action of $\mathcal{L}_X$ on $\mathfrak{g}^*$. 

\begin{remark}
	The minus sign in $e^{-tX_a}$ in the fundamental vector field over $V$ in
	equation (\ref{eq:interior_dx}) arises due to the fact that the
	$\SO(V)$-action on $V$ is a right action. In general, this is so that the
	map $\g \to \Gamma(TM)$ is a Lie algebra homomorphism. 
\end{remark}	
 
% TODO prove equivalence to usual form
To relate our formula to other versions in literature, let $\chi =
(e_1,\ldots,e_n)$ be the Grassman variables for $V$. 
In more compact notation, the third term of $\sigma$ can be written  
as $\frac{1}{2} e_i \wedge (\rho_*)_{ij} e_j = \frac{1}{2} \chi^\intercal
(\rho_*) \chi$. Then the Mathai-Quillen Thom form 
$U\in S(\mathfrak{g}^*)\otimes \Omega(V)$ can be alternatively written as 
\begin{equation} \label{eq:universal_thom_form} % AJ 2.1
	U = \epsilon(n)(2\pi)^{-n /2}e^{-\abs{x}^2} 
	\int^B \exp \paren{\frac{1}{2}\chi^{\intercal}(\rho_*)\chi -
idx^{\intercal}\chi} \odif{\chi} 
\end{equation}
If $\rho_*(X)\in\so(V)$ is always invertible, we can apply
Proposition \ref{prop:berezin_formula}, to get
\[
	U = \epsilon(n)(2\pi)^{-n/2} \Pf(\rho_*) \exp(-\abs{x}^2-dx^{\intercal} (\rho_*)^{-1}dx)
\] 
We can also obtain a universal Thom form in the Weil model, by 
applying the Weil-Cartan isomorphism $(S(\mathfrak{g}^*)\otimes \Omega(V))^G
\xrightarrow{\simeq}(W(\mathfrak{g})\otimes \Omega(V))_{bas}$. 

\begin{comment} % Mathai-Quillen forms in Weil model 
\[% cordes eq11.12
		U = (2\pi)^{-m} \Pf(\phi) \exp(-\abs{x}^2-\gen{\nabla x,\phi^{-1}\nabla x})
\] 
\[%MQformula weil eq 6.2 (extended from 1.8)
	U = (2\pi)^{-m}\Pf(\Omega) \exp(-x^2-(dx+\theta x)^\intercal \Omega^{-1}
	(dx+\theta x))
\]
\end{comment}
\section{Localisation}
One of the primitive applications of the Mathai-Quillen formula is to prove the
Poincar\'e-Hopf theorem. 
Let $v\in\mathcal{X}(M)$ be a vector field on $M$.
At a zero $p\in M$ of  $v$, the Lie bracket of vector fields defines an endomorphism 
$\mathcal{L}_p(v) : T_pM \to T_pM$ by  $X\mapsto [X,v]$. In a coordinate system in
which  $p=0$ and  $v= v^i \partial_i$,  $\mathcal{L}_p(v)$ is given by 
 \[
	 \mathcal{L}_p(v)\partial_i = \sum_{j=1}^{n} [\partial_i, v^j(p)\partial^j] 
	 = \sum_{j=1}^{n} (\partial_i v_j(p)) \partial_j
\] 
A zero $p\in M$ is called \underline{non-degenerate} if  $\mathcal{L}_p(v)$ is
invertible. In this case, denote $\nu(p,v) = \sgn \det(\mathcal{L}_p(v)) 
\in \{\pm 1\}$. If all of the zeros of $v$ are non-degenerate, we call  $v$
non-degenerate. 

\begin{thm}[Poincare-Hopf] % Thm 1.56 BGV
	If $v$ is a non-degenerate vector field on an oriented compact manifold $M$ 
	of dimension $n$, then 
	\[
		 \int_M \chi(TM) = \sum_{\set{p|v(p)=0}} \nu(p,v)	
	\] 
\end{thm}
\begin{proof}
	(adapted from \cite[Theorem 1.56]{bgv})
	Choose a chart $\phi_p : U_p \to \mathbb{R}^n$ in a neighbourhood $U_p$ of
	each zero $p\in M$ of $v$, which gives coordinates on the tangent bundle 
	$\psi_p : TU_p \to \mathbb{R}^n$. The vector field $v$ defines a
	smooth map $\psi_p \circ v : U_p\to \mathbb{R}^n$ 
	with $v(p) = 0$ and invertible
	derivative $\mathcal{L}_p(v)$. 
	% TODO why is this the derivative?

	By the inverse function theorem, $v$ is a local diffeomorphism
	between open neighbourhoods $V_p \subset U_p$ and $B \subset \mathbb{R}^n$. 
	The orientation on $V_p$ induced by the oriented chart $\phi_p$ and by 
	the local diffeomorphism $\psi_p \circ v$ differ by the sign $\nu(p,v)$. 

	We may assume  $V_p$ are disjoint for each $p$.  Choose a Riemannian metric
	on $M$ which agrees with the metric on each $V_p$ induced by the diffeomorphism
	into  $\mathbb{R}^n$. Since $M$ is compact,  $\exists \epsilon > 0$ such
	that  $\norm{v} \geq \epsilon$ on the compact set  $M\setminus \bigcup_p V_p$,
	because if $\norm{v}$ can get arbitrarily close to 0, we would find a convergent
	subsequence in $M\setminus \bigcup_p V_p$ whose limit is a zero of $v$.  

	Let $U\in \Omega^n(TM)$ be the Mathai-Quillen Thom form of  $TM$ with respect to the
	Riemannian metric and associated Levi-Civita connection. 
	Let $f : \mathbb{R}_+ \to [0,1]$ be a smooth bump function such that $f(s)=1$
	if  $s < \epsilon^2 /4$ and $f(s)=0$ if  $s>\epsilon^2$. Then for all $t>0$
	\begin{equation} \label{eq:euler_zeros}
			\int_M \chi(TM) = \int_M v_t^* U 
		= \int_M (1-f(\norm{v}^2))v_t^*U  + \int_M f(\norm{v}^2)v_t^*U
	\end{equation}
	where $v_t := tv$. From equation (\ref{eq:MQ_exp}), we see that
	$v_t^* U$ is of the form
	\[
		v_t^*U = e^{-t^2\norm{v}^2 /2} \sum_{k=0}^{n} t^k \alpha_k
	\] 
	where $\alpha_k \in \Omega(M)$. Therefore, the first integral in equation
	(\ref{eq:euler_zeros}) is rapidly decreasing in $t$ since $\norm{v}^2 >
	\epsilon^2 /4$, and approaches zero as $t\to\infty$.

	On each $V_p$, the metric and connection are trivial since they are induced 
	by $v$. If we write $v= \sum_{i=1}^{n} x^i \partial_i$ in the coordinates of
	the chart $\psi_p$,
	\begin{align*}
		v_t^*U |_{V_p} 
		&= (2\pi)^{-n/2} e^{-t^2\norm{x}^2 /2} \int^B e^{-itdv} \\
		&= (2\pi)^{-n/2} \nu(p,v) e^{-t^2\norm{x}^2 /2} t^n dx^1 \wedge
		\ldots\wedge dx^n \tag{using Lemma \ref{lem:gaussian_integral}}
	\end{align*}
	The sign $\nu(p,v)$ comes from the Berezin integral using the orientation of
	the manifold, while $x^1,\ldots,x^n$ are coordinates of the vector field. 
	Therefore, 
	\begin{align*}
		\lim_{t \to \infty} \int_{V_p} f(\norm{v}^2)v_t^*U 
		&= (2\pi)^{-n/2} \nu(p,v) 
		\lim_{t \to \infty} \int_{\mathbb{R}^n}
		f(\norm{x}^2) e^{-t^2\norm{x}^2 /2} t^n dx^1 \wedge \ldots\wedge dx^n\\
		&= (2\pi)^{-n/2} \nu(p,v) 
		\lim_{t \to \infty} \int_{\mathbb{R}^n} 
		f(\norm[*]{t^{-1}y}^2) e^{-\norm{y}^2 /2} dy^1 \wedge \ldots\wedge dy^n\\
		&= \nu(p,v) 
	\end{align*}
	where we have made the change of variables $x=t^{-1}y$. Summing over each of
	the neighbourhoods $V_p$ of zeros, we get the result.
\end{proof}

There is a generalisation of this result, where we assume that the zeros
of $v$ are isolated instead of non-degenerate.\cite[Theorem 1.58]{bgv} 
It is desirable to generalise this further to relate the Euler number of
arbitrary vector bundles to zeros of a section, but the Poincar\'e-Hopf theorem
relies on the Lie bracket of vector fields to define the orientation of each
zero. As we will see below, there is in fact such a generalisation.

% p51 Bott Tu
Poincar\'e duality (Theorem \ref{thm:poincare_duality}) can be used to associate 
every compact and oriented 
submanifold $i: S \xhookrightarrow{} M$ of dimension  $k$, 
to a unique cohomology class  $[\eta_s]\in H^{n-k}_c(M)$ called its
\underline{Poincare dual} as follows. Define the linear functional
\[
H^k(M) \to \mathbb{R}, \qquad 
\omega \mapsto \int_S i^*\omega
\] 
Note that $\int_S i^*\omega$ is defined because $S$ is compact. 
It follows by Poincare duality that integration over $S$ corresponds to a
unique cohomology class $[\eta_S]\in H^{n-k}_c(M)$, with the property that 
for any closed $\omega\in \Omega^k(M)$
\[
\int_S i^*\omega = \int_M \omega \wedge \eta_S
\] 
Now, if $W\subset M$ is an open subset containing $S$, then the Poincar\'e dual
of  $S$ in  $W$,  $\eta_S' \in H_c^{n-k}(W)$ extends by 0 to a representative 
$\eta_S\in H_c^{n-k}(M)$ of the Poincar\'e dual in $M$. 
Therefore, the support of $\eta_S$ can be shrunk into an arbitrarily small
neighbourhood of  $S$, and this is called the \underline{localisation
principle}. 

However, we would still like to relate these ideas to the Euler/Thom class, which
requires constructing a vector bundle. We can do this by introducing the concept
of a tubular neighbourhood.
\begin{defn}
	Let $S$ be a submanifold of dimension  $k$ in a manifold  $M$ of dimension
	$n$. A \underline{tubular neighbourhood} of  $S$ in  $M$ is an open
	neighbourhood of  $S$ in  $M$ diffeomorphic to a vector bundle of rank
	$n-k$ over  $S$, such that  $S$ is diffeomorphic to the zero section.

	The \underline{normal bundle} of $S$ in  $M$ is the quotient vector bundle
	$N\to S$ defined by the exact sequence 
	\[
	\begin{tikzcd}[column sep = 1.6em]
		0 \arrow[r] & TS \arrow[r,"i_*"] & TM|_S \arrow[r] 
						& N \arrow[r] & 0
	\end{tikzcd}
	\] 	
	For a Riemannian manifold, one can identify $N$ with the orthogonal
	complement.
\end{defn}

% https://luis.impa.br/aulas/anvar/Spivak_Vol1_3ed.pdf Spival p346
% https://www.math.tecnico.ulisboa.pt/~acannas/Books/lsg.pdf p37
% http://alpha.math.uga.edu/~usher/8210-notes2.pdf Thm 2.11
\begin{thm}[Tubular neighbourhood theorem {\cite[Theorem 6.5]{anacannas}}] 
	Every submanifold $S$ of a smooth manifold $M$ has a 
	tubular neighbourhood  $T\subset M$, and  
	$T$ is diffeomorphic to the normal bundle of $S$ in $M$.
\end{thm}
%TODO diagram of tubular neighbourhood

Let $S$ be a compact oriented submanifold of an oriented manifold $M$. 
% which is closed as a subspace. % Not using closed homology, see BottTu p51 
If $j:T \hookrightarrow M$ is the inclusion of a tubular neighborhood of $S$, 
we have a Thom class $U \in H^{n-k}_{cv}(T)$ by identifying $T$ with the normal
bundle of $S$. 
We can define a map $j_*:H_{cv}^{*}(T) \to H^*(M)$ which extends by zero,
because forms that are compactly supported along the fiber go to zero near 
the boundary of $T$. 
The normal bundle $N\to S$ is given an orientation
such that $N\oplus TS = TM|_S$ has the direct sum orientation. 
The following
theorem relates the Poincar\'e dual to the Thom class:
\begin{thm}[Poincar\'e dual as a Thom class] % p67 Bott Tu
	The Poincar\'e dual of $S$ is the Thom class of the
	normal bundle $N \to S$. More precisely, 
	\[
		\int_M \omega\wedge j_*U = \int_S i^*\omega 
	\] 
	for all $\omega\in H^k(M)$, where $U\in H^{n-k}_{cv}(T)$ is the Thom form.
\end{thm}
\begin{proof}
	Let $\omega \in H^k(M)$. Consider $\omega$ as a form on  $T$, since
	we are not concerned with its values outside this region, so we may view
	the inclusion $i : S \to T$ as the zero section. Note that $\pi : T \to S$
	induces a deformation retraction of $T$ onto $S$, so $\pi$ and  $i$
	are inverse isomorphisms in cohomology. This means $\omega$ differs from
	$\pi^*i^*\omega$ by an exact form:  $\omega = \pi^*i^*\omega + d\tau$.
	\begin{align*}
		\int_M \omega\wedge j_*U 
		= \int_T \omega \wedge U 
		&= \int_T (\pi^*i^*\omega + d\tau) \wedge U \\
		&= \int_T (\pi^*i^*\omega) \wedge U \tag{by Stokes' theorem}\\
		&= \int_S i^*\omega  \wedge \pi_*U 
		\tag{by Proposition \ref{prop:projection_formula}}\\
		&= \int_S i^*\omega \tag{since $\pi_*U = 1$} 
	\end{align*}
\end{proof}
\vspace{-1.5ex}
In particular, this means that the Poincar\'e dual of the zero section of a
vector bundle $E\to M$ is the same as the Thom class of  $E$, since the normal
bundle of the zero section is  $E$ itself. It will be useful to review
transversality in Appendix \ref{appendix4} before reading the rest of this
chapter.
\begin{thm} % Bott Tu pg 69 
	Suppose $f\in C^\infty(N,M)$ is an orientation-preserving map of oriented
	manifolds, $S\subset M$ is a compact oriented submanifold, and $T\subset M$
	is a tubular neighbourhood of $S$. 
	If $f$ is transverse to  $S$ and  $T$, then
	$\eta_{f^{-1}(S)} = f^*\eta_S$, i.e. for all  $\omega\in H^k(N)$,
	\[
	\int_{N} \omega \wedge f^*\eta_S =\int_{f^{-1}(S)} i^*\omega  
	\] 
	where $i: f^{-1}(S) \to N$ is the inclusion map.
\end{thm}
\begin{proof}
	Let the dimensions of $N,M$ and  $S$ be  $n,m$ and  $k$ respectively.
	By Theorem \ref{thm:inverse_submanifold}, $f^{-1}S\subset N$ is a submanifold 
	of dimension $n-m+k$. Similarly, $f^{-1}T \subset N$ is a neighbourhood of 
	dimension $n$. So the normal bundles of $S$ and  $f^{-1}(S)$ are of the same
	rank. 
	We can choose $T$ to be a sufficiently small tubular
	neighbourhood of  $S$ such that  

	$f^{-1}T$ is contained within a tubular
	neighbourhood of $f^{-1}S$ in $N$, and hence diffeomorphic to 

	\begin{comment} % normal bundle is pullback
	First observe that $f \pitchfork S$ if and only if  $Df|_x$ maps
	surjectively to the quotient vector space $T_{f(x)}M /T_{f(x)} S =
	(N_S)_{f(x)}$ for all $x\in f^{-1}(S)$. Denote by $N_{f^{-1}(S)}$ the normal
	bundle of $f^{-1}(S)$ in $N$. Since $Df|_x$ sends  $T_xf^{-1}(S)$ to
	$T_{f(x)}S$, it descends to a surjective map on the quotient vector spaces
	$Df|_x : (N_{f^{-1}(S)})_x \to (N_S)_{f(x)}$. So it must be a linear
	isomorphism because the dimensions are both equal to $m-k$.
	Therefore, $Df : N_{f^{-1}(S)} \to f^*N_{S}$ is a bundle isomorphism. 
	\end{comment}

	%TODO why T sufficiently small 

	The following diagram commutes (why?)
	% https://q.uiver.app/?q=WzAsNixbMCwwLCJIXiooUykiXSxbMSwwLCJIXnsqK2t9KFQpIl0sWzIsMCwiSF4qKE0pIl0sWzIsMSwiSF4qKE0nKSJdLFsxLDEsIkheeyora30oZl57LTF9VCkiXSxbMCwxLCJIXiooZl57LTF9UykiXSxbMCw1LCJmXioiXSxbMSw0LCJmXioiXSxbMiwzLCJmXioiXSxbMCwxLCJcXHdlZGdlIFxcUGhpKFQpIl0sWzEsMiwial8qIl0sWzQsMywial8qIl0sWzUsNCwiXFx3ZWRnZSBcXFBoaShmXnstMX1UKSJdXQ==
	\[\begin{tikzcd}[row sep=2.85em, column sep=4.45em]
			{H^*(S)} & {H^{*+k}_{cv}(T)} & {H^*(M)} \\
				{H^*(f^{-1}S)} & {H^{*+k}_{cv}(f^{-1}T)} & {H^*(M')}
					\arrow["{f^*}", from=1-1, to=2-1]
						\arrow["{f^*}", from=1-2, to=2-2]
							\arrow["{f^*}", from=1-3, to=2-3]
								\arrow["{\wedge \Phi(T)}", from=1-1, to=1-2]
									\arrow["{j_*}", from=1-2, to=1-3]
										\arrow["{j_*}", from=2-2, to=2-3]
											\arrow["{\wedge \Phi(f^{-1}T)}",
											from=2-1, to=2-2]
	\end{tikzcd}\]
	Starting with $1\in H^0(S)$, the maps on the top row gives 
	$\eta_S \in H^{n-k}(M) \mapsto f^*\eta_S \in H^{n-k}(M')$ 
	On the other hand, the maps on the bottom row gives
	$\eta_{f^{-1}S} \mapsto \eta_{f^{-1}S} \in H^{n-k}$
\end{proof}

% TODO is there a dimension condition? dim m \geq dim W
\begin{cor} \label{cor:vb_localisation} % prop 12.8 Bott Tu
	Let $E\to M$ be an oriented vector bundle of rank $k$ over an oriented 
	manifold of dimension $n$, 
	and $s\in M\to E$ be a section which is transverse to the zero section.
	Then for all $\omega\in \Omega^{n-k}_c(M)$,
	\[
	\int_M \omega \wedge s^* \Phi(E) =\int_{s^{-1}(0)} i^*\omega  
	\] 
\end{cor}
\begin{proof}
% TODO where is transversality used 
% how transversality homotopy theorem does not require this
	This follows from choosing the section to be the orientation preserving map, and
	choosing the submanifold of $0\subset E$ to be the image of the zero section.
	Since $0\subset E$ is a diffeomorphic embedding of $M$ in $E$, and we have the
	exact sequence
\[
	\begin{tikzcd}[column sep = 1.6em]
		0 \arrow[r] & T0 \arrow[r] & TE|_0 \arrow[r] 
						& E \arrow[r] & 0
	\end{tikzcd}
	\]
	the normal bundle of  $0\subset E$ is  $E$ itself.
	Hence $\eta_0 = \Phi(E)$. 
\end{proof}

% discussion from Witten N matrix model 3.3, cordes 11.10.3, physical p15
% TODO
There is an extension of the previous result for a section $s$ which is not
transverse to the zero section, but with constant rank so that $s^{-1}(0)$ is a
manifold. 

Let $E\to M$ be a vector bundle over a finite-dimensional compact manifold  $M$.
If $s\in\Gamma(M,E)$ is a generic section and $\dim M \geq \rank E$, 
$S=s^{-1}(0)$ is a submanifold with
Poincare dual $s^*\Phi(E)=\chi(E)$ by Corollary \ref{cor:vb_localisation}. 
By the rank-nullity theorem, we would have $\dim S = \rank M - \rank E$. But 
we wish to consider a non-generic section $s$, i.e. not transverse to the zero
section: $\dim S > \dim(M)-\rank(E)$ such that the fibers of $\coker(\nabla s)$
has constant rank and defines a smooth vector bundle. Given orientations of  $M$
and  $E$,  $\coker(\nabla s)$ is canonically oriented.

\begin{thm}[Generalised localisation theorem]
	Let  $\coker(\nabla s) \to S$ be the vector bundle of dimension
	$\dim(M)-\dim(S)$.  

	Let  $u\in\Gamma(S,N)$ be a generic section and
	$P=u^{-1}(0)$ which has Poincare dual $\chi(V')$. Since  $P\subset S \subset M$,
	we claim that $i(P)$ is Poincare dual to  $\chi(E)$.
\[
\int_M \chi(E\to M)\wedge \omega 
= \int_{S} i^*\omega \wedge \chi(\coker(\nabla s)\to S)
\]
\end{thm}

 
Note that if $s$ is a generic section then  $\coker (\nabla s) = \{0\}$, which
reduces to Corollary \ref{cor:vb_localisation}.




\vspace{5mm}
\hrule 
\vspace{5mm}

\textbf{Bibliographical notes}
{\small
\begin{itemize}
	\item A more comprehensive treatment of the Thom isomorphism can be found in
		\citet{bott_tu}.  
	\item The Mathai-Quillen formula described in section
		\ref{section:mq_formula} is based on section 
		section 1.6 of \cite{bgv}.
	\item The book by \citet{guillemin} gives an exposition of the
	Mathai-Quillen formula in the equivariant case 
\end{itemize}
}
